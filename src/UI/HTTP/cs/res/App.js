// Generated by psc version 0.6.8
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    
    function cons(e) {
      return function(l) {
        return [e].concat(l);
      };
    }
    ;
    
    function showStringImpl(s) {
      return JSON.stringify(s);
    }
    ;
    
    function showNumberImpl(n) {
      return n.toString();
    }
    ;
    
    function numAdd(n1) {
      return function(n2) {
        return n1 + n2;
      };
    }
    ;
    
    function numSub(n1) {
      return function(n2) {
        return n1 - n2;
      };
    }
    ;
    
    function numMul(n1) {
      return function(n2) {
        return n1 * n2;
      };
    }
    ;
    
    function refEq(r1) {
      return function(r2) {
        return r1 === r2;
      };
    }
    ;
    
    function refIneq(r1) {
      return function(r2) {
        return r1 !== r2;
      };
    }
    ;
    
    function unsafeCompareImpl(lt) {
      return function(eq) {
        return function(gt) {
          return function(x) {
            return function(y) {
              return x < y ? lt : x > y ? gt : eq;
            };
          };
        };
      };
    }
    ;
    
    function numShl(n1) {
      return function(n2) {
        return n1 << n2;
      };
    }
    ;
    
    function numShr(n1) {
      return function(n2) {
        return n1 >> n2;
      };
    }
    ;
    
    function numZshr(n1) {
      return function(n2) {
        return n1 >>> n2;
      };
    }
    ;
    
    function numAnd(n1) {
      return function(n2) {
        return n1 & n2;
      };
    }
    ;
    
    function numOr(n1) {
      return function(n2) {
        return n1 | n2;
      };
    }
    ;
    
    function numXor(n1) {
      return function(n2) {
        return n1 ^ n2;
      };
    }
    ;
    
    function numComplement(n) {
      return ~n;
    }
    ;
    
    function boolAnd(b1) {
      return function(b2) {
        return b1 && b2;
      };
    }
    ;
    
    function boolOr(b1) {
      return function(b2) {
        return b1 || b2;
      };
    }
    ;
    
    function boolNot(b) {
      return !b;
    }
    ;
    
    function concatString(s1) {
      return function(s2) {
        return s1 + s2;
      };
    }
    ;
    var Unit = function (x) {
        return x;
    };
    var LT = (function () {
        function LT() {

        };
        LT.value = new LT();
        return LT;
    })();
    var GT = (function () {
        function GT() {

        };
        GT.value = new GT();
        return GT;
    })();
    var EQ = (function () {
        function EQ() {

        };
        EQ.value = new EQ();
        return EQ;
    })();
    var Semigroupoid = function ($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    var Show = function (show) {
        this.show = show;
    };
    var Functor = function ($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    var Apply = function ($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var Applicative = function (__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    var Bind = function ($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    var Monad = function (__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    
    /**
     *  | Addition and multiplication
     */
    var Semiring = function ($times, $plus, one, zero) {
        this["*"] = $times;
        this["+"] = $plus;
        this.one = one;
        this.zero = zero;
    };
    
    /**
     *  | Addition, multiplication, and subtraction
     */
    var Ring = function ($minus, __superclass_Prelude$dotSemiring_0) {
        this["-"] = $minus;
        this["__superclass_Prelude.Semiring_0"] = __superclass_Prelude$dotSemiring_0;
    };
    var Eq = function ($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    var Ord = function (__superclass_Prelude$dotEq_0, compare) {
        this["__superclass_Prelude.Eq_0"] = __superclass_Prelude$dotEq_0;
        this.compare = compare;
    };
    var Bits = function ($dot$amp$dot, $dot$up$dot, $dot$bar$dot, complement, shl, shr, zshr) {
        this[".&."] = $dot$amp$dot;
        this[".^."] = $dot$up$dot;
        this[".|."] = $dot$bar$dot;
        this.complement = complement;
        this.shl = shl;
        this.shr = shr;
        this.zshr = zshr;
    };
    var BoolLike = function ($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    var Semigroup = function ($less$greater) {
        this["<>"] = $less$greater;
    };
    var $bar$bar = function (dict) {
        return dict["||"];
    };
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $colon = cons;
    var $div$eq = function (dict) {
        return dict["/="];
    };
    
    /**
     *  | Addition, multiplication, and subtraction
     */
    var $minus = function (dict) {
        return dict["-"];
    };
    var $plus$plus = function (__dict_Semigroup_2) {
        return $less$greater(__dict_Semigroup_2);
    };
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var $hash = function (x) {
        return function (f) {
            return f(x);
        };
    };
    var unsafeCompare = unsafeCompareImpl(LT.value)(EQ.value)(GT.value);
    var unit = {};
    var showString = new Show(showStringImpl);
    var showNumber = new Show(showNumberImpl);
    var show = function (dict) {
        return dict.show;
    };
    var semiringNumber = new Semiring(numMul, numAdd, 1, 0);
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupString = new Semigroup(concatString);
    var ringNumber = new Ring(numSub, function () {
        return semiringNumber;
    });
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_5) {
        return pure(__dict_Monad_5["__superclass_Prelude.Applicative_0"]());
    };
    
    /**
     *  | An alias for `true`, which can be useful in guard clauses:
     *  |
     *  | E.g.
     *  |
     *  |     max x y | x >= y = x
     *  |             | otherwise = y
     */
    var otherwise = true;
    var not = function (dict) {
        return dict.not;
    };
    var liftA1 = function (__dict_Applicative_8) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_8["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_8)(f))(a);
            };
        };
    };
    
    /**
     *  | Flips the order of the arguments to a function of two arguments.
     */
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqString = new Eq(refIneq, refEq);
    var eqNumber = new Eq(refIneq, refEq);
    var ordNumber = new Ord(function () {
        return eqNumber;
    }, unsafeCompare);
    
    /**
     *  | Returns its first argument and ignores its second.
     */
    var $$const = function (_164) {
        return function (_165) {
            return _164;
        };
    };
    var complement = function (dict) {
        return dict.complement;
    };
    var compare = function (dict) {
        return dict.compare;
    };
    var $less = function (__dict_Ord_12) {
        return function (a1) {
            return function (a2) {
                var _792 = compare(__dict_Ord_12)(a1)(a2);
                if (_792 instanceof LT) {
                    return true;
                };
                return false;
            };
        };
    };
    var $greater = function (__dict_Ord_14) {
        return function (a1) {
            return function (a2) {
                var _793 = compare(__dict_Ord_14)(a1)(a2);
                if (_793 instanceof GT) {
                    return true;
                };
                return false;
            };
        };
    };
    var $greater$eq = function (__dict_Ord_15) {
        return function (a1) {
            return function (a2) {
                var _794 = compare(__dict_Ord_15)(a1)(a2);
                if (_794 instanceof LT) {
                    return false;
                };
                return true;
            };
        };
    };
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var bitsNumber = new Bits(numAnd, numXor, numOr, numComplement, numShl, numShr, numZshr);
    var ap = function (__dict_Monad_16) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_16["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_16["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_16)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        Unit: Unit, 
        LT: LT, 
        GT: GT, 
        EQ: EQ, 
        Semigroup: Semigroup, 
        BoolLike: BoolLike, 
        Bits: Bits, 
        Ord: Ord, 
        Eq: Eq, 
        Ring: Ring, 
        Semiring: Semiring, 
        Monad: Monad, 
        Bind: Bind, 
        Applicative: Applicative, 
        Apply: Apply, 
        Functor: Functor, 
        Show: Show, 
        Semigroupoid: Semigroupoid, 
        unit: unit, 
        "++": $plus$plus, 
        "<>": $less$greater, 
        not: not, 
        "||": $bar$bar, 
        complement: complement, 
        ">=": $greater$eq, 
        ">": $greater, 
        "<": $less, 
        compare: compare, 
        refIneq: refIneq, 
        refEq: refEq, 
        "/=": $div$eq, 
        "==": $eq$eq, 
        "-": $minus, 
        ap: ap, 
        "return": $$return, 
        ">>=": $greater$greater$eq, 
        liftA1: liftA1, 
        pure: pure, 
        "<*>": $less$times$greater, 
        "<$>": $less$dollar$greater, 
        show: show, 
        cons: cons, 
        ":": $colon, 
        "#": $hash, 
        "$": $dollar, 
        "<<<": $less$less$less, 
        "const": $$const, 
        flip: flip, 
        otherwise: otherwise, 
        semigroupoidArr: semigroupoidArr, 
        showString: showString, 
        showNumber: showNumber, 
        semiringNumber: semiringNumber, 
        ringNumber: ringNumber, 
        eqString: eqString, 
        eqNumber: eqNumber, 
        ordNumber: ordNumber, 
        bitsNumber: bitsNumber, 
        boolLikeBoolean: boolLikeBoolean, 
        semigroupString: semigroupString
    };
})();
var PS = PS || {};
PS.Prelude_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function unsafeIndex(xs) {
      return function(n) {
        return xs[n];
      };
    }
    ;
    return {
        unsafeIndex: unsafeIndex
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function split(sep) {  return function(s) {    return s.split(sep);  };};
    return {
        split: split
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function runFn2(fn) {
      return function(a) {
        return function(b) {
          return fn(a, b);
        };
      };
    }
    ;
    
    function runFn3(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return fn(a, b, c);
          };
        };
      };
    }
    ;
    
    function runFn4(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return fn(a, b, c, d);
            };
          };
        };
      };
    }
    ;
    return {
        runFn4: runFn4, 
        runFn3: runFn3, 
        runFn2: runFn2
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function returnE(a) {
      return function() {
        return a;
      };
    }
    ;
    
    function bindE(a) {
      return function(f) {
        return function() {
          return f(a())();
        };
      };
    }
    ;
    
    function runPure(f) {
      return f();
    }
    ;
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        runPure: runPure, 
        bindE: bindE, 
        returnE: returnE, 
        functorEff: functorEff, 
        applyEff: applyEff, 
        applicativeEff: applicativeEff, 
        bindEff: bindEff, 
        monadEff: monadEff
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Ref = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
  function newRef(val) {
    return function () {
      return { value: val };
    };
  }
;
    
  function readRef(ref) {
    return function() {
      return ref.value;
    };
  }
;
    
  function writeRef(ref) {
    return function(val) {
      return function() {
        ref.value = val;
        return {};
      };
    };
  }
;
    return {
        writeRef: writeRef, 
        readRef: readRef, 
        newRef: newRef
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
    function unsafeInterleaveEff(f) {
      return f;
    }
    ;
    return {
        unsafeInterleaveEff: unsafeInterleaveEff
    };
})();
var PS = PS || {};
PS.Debug_Trace = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
    function trace(s) {
      return function() {
        console.log(s);
        return {};
      };
    }
    ;
    return {
        trace: trace
    };
})();
var PS = PS || {};
PS.React = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var spec = {};;
    function createClass(psSpec) {  var spec = {};  for (var fun in psSpec) {    if (psSpec.hasOwnProperty(fun)) {      (function(f) {        if (typeof psSpec[f] === 'function') {          spec[f] = function() {            return psSpec[f].apply(this, [this].concat([].slice.call(arguments)))() ;          }        } else {          spec[f] = psSpec[f];        }      })(fun);    }  }  var Class = React.createClass(spec);  return function(props) {    return function(children) {      return Class(props, children);    }  }};
    function renderComponent(component) {  return function(element) {    return function() {      return React.renderComponent(component, element);    }  }};
    function eventHandler(that) {  return function(f) {    return function(e) {      return f(that)(e)();    }  }};
    var renderComponentById = function (component) {
        return function (id) {
            return renderComponent(component)(document.getElementById(id));
        };
    };
    return {
        renderComponentById: renderComponentById, 
        eventHandler: eventHandler, 
        renderComponent: renderComponent, 
        createClass: createClass, 
        spec: spec, 
        document: document
    };
})();
var PS = PS || {};
PS.React_DOM = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Function = PS.Data_Function;
    var React_Types = PS.React_Types;
    function dom(el) {  return function(props) {    return function(children) {      return React.DOM[el].apply(this, [props].concat(children));    }  }};
    function rawText(text) {  return text;};
    var ul = dom("ul");
    var span = dom("span");
    var li = dom("li");
    var input = dom("input");
    var img = dom("img");
    var div = dom("div");
    var button = dom("button");
    var a = dom("a");
    return {
        ul: ul, 
        span: span, 
        li: li, 
        input: input, 
        img: img, 
        div: div, 
        button: button, 
        a: a, 
        rawText: rawText, 
        dom: dom
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Left = (function () {
        function Left(value0) {
            this.value0 = value0;
        };
        Left.create = function (value0) {
            return new Left(value0);
        };
        return Left;
    })();
    var Right = (function () {
        function Right(value0) {
            this.value0 = value0;
        };
        Right.create = function (value0) {
            return new Right(value0);
        };
        return Right;
    })();
    var functorEither = new Prelude.Functor(function (_211) {
        return function (_212) {
            if (_212 instanceof Left) {
                return new Left(_212.value0);
            };
            if (_212 instanceof Right) {
                return new Right(_211(_212.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var either = function (_208) {
        return function (_209) {
            return function (_210) {
                if (_210 instanceof Left) {
                    return _208(_210.value0);
                };
                if (_210 instanceof Right) {
                    return _209(_210.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var applyEither = new Prelude.Apply(function (_213) {
        return function (_214) {
            if (_213 instanceof Left) {
                return new Left(_213.value0);
            };
            if (_213 instanceof Right) {
                return Prelude["<$>"](functorEither)(_213.value0)(_214);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var bindEither = new Prelude.Bind(either(function (e) {
        return function (_207) {
            return new Left(e);
        };
    })(function (a) {
        return function (f) {
            return f(a);
        };
    }), function () {
        return applyEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    var monadEither = new Prelude.Monad(function () {
        return applicativeEither;
    }, function () {
        return bindEither;
    });
    return {
        Left: Left, 
        Right: Right, 
        either: either, 
        functorEither: functorEither, 
        applyEither: applyEither, 
        applicativeEither: applicativeEither, 
        bindEither: bindEither, 
        monadEither: monadEither
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Extend = PS.Control_Extend;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Control_Plus = PS.Control_Plus;
    var Nothing = (function () {
        function Nothing() {

        };
        Nothing.value = new Nothing();
        return Nothing;
    })();
    var Just = (function () {
        function Just(value0) {
            this.value0 = value0;
        };
        Just.create = function (value0) {
            return new Just(value0);
        };
        return Just;
    })();
    return {
        Nothing: Nothing, 
        Just: Just
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Prelude_Unsafe = PS.Prelude_Unsafe;
    function length (xs) {  return xs.length;};
    function append (l1) {  return function (l2) {    return l1.concat(l2);  };};
    function reverse (l) {  return l.slice().reverse();};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    function filter (f) {  return function (arr) {    var n = 0;    var result = [];    for (var i = 0, l = arr.length; i < l; i++) {      if (f(arr[i])) {        result[n++] = arr[i];      }    }    return result;  };};
    function range (start) {  return function (end) {    var i = ~~start, e = ~~end;    var step = i > e ? -1 : 1;    var result = [i], n = 1;    while (i !== e) {      i += step;      result[n++] = i;    }    return result;  };};
    function zipWith (f) {  return function (xs) {    return function (ys) {      var l = xs.length < ys.length ? xs.length : ys.length;      var result = new Array(l);      for (var i = 0; i < l; i++) {        result[i] = f(xs[i])(ys[i]);      }      return result;    };  };};
    var $bang$bang = function (xs) {
        return function (n) {
            var isInt = function (n_1) {
                return n_1 !== ~~n_1;
            };
            var _811 = n < 0 || (n >= length(xs) || isInt(n));
            if (_811) {
                return Data_Maybe.Nothing.value;
            };
            if (!_811) {
                return new Data_Maybe.Just(xs[n]);
            };
            throw new Error("Failed pattern match");
        };
    };
    var semigroupArray = new Prelude.Semigroup(append);
    var head = function (_251) {
        if (_251.length >= 1) {
            var _814 = _251.slice(1);
            return new Data_Maybe.Just(_251[0]);
        };
        return Data_Maybe.Nothing.value;
    };
    var functorArray = new Prelude.Functor(map);
    return {
        zipWith: zipWith, 
        range: range, 
        filter: filter, 
        reverse: reverse, 
        append: append, 
        length: length, 
        map: map, 
        head: head, 
        "!!": $bang$bang, 
        functorArray: functorArray, 
        semigroupArray: semigroupArray
    };
})();
var PS = PS || {};
PS.Data_Foreign = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Function = PS.Data_Function;
    var Data_Array = PS.Data_Array;
    var Data_Either = PS.Data_Either;
    
  function parseJSONImpl(left, right, str) {
    try {
      return right(JSON.parse(str));
    } catch (e) {
      return left(e.toString());
    }
  }
  ;
    
  function unsafeFromForeign(value) {
    return value;
  }
  ;
    
  function typeOf(value) {
    return typeof value;
  }
  ;
    
  function tagOf(value) {
    return Object.prototype.toString.call(value).slice(8, -1);
  }
  ;
    
  function isNull(value) {
    return value === null;
  }
  ;
    
  function isUndefined(value) {
    return value === undefined;
  }
  ;
    
  var isArray = Array.isArray || function(value) {
    return Object.prototype.toString.call(value) === '[object Array]';
  };
  ;
    var TypeMismatch = (function () {
        function TypeMismatch(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        TypeMismatch.create = function (value0) {
            return function (value1) {
                return new TypeMismatch(value0, value1);
            };
        };
        return TypeMismatch;
    })();
    var ErrorAtIndex = (function () {
        function ErrorAtIndex(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        ErrorAtIndex.create = function (value0) {
            return function (value1) {
                return new ErrorAtIndex(value0, value1);
            };
        };
        return ErrorAtIndex;
    })();
    var ErrorAtProperty = (function () {
        function ErrorAtProperty(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        ErrorAtProperty.create = function (value0) {
            return function (value1) {
                return new ErrorAtProperty(value0, value1);
            };
        };
        return ErrorAtProperty;
    })();
    var JSONError = (function () {
        function JSONError(value0) {
            this.value0 = value0;
        };
        JSONError.create = function (value0) {
            return new JSONError(value0);
        };
        return JSONError;
    })();
    var unsafeReadPrim = function (_272) {
        return function (_273) {
            if (tagOf(_273) === _272) {
                return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_273));
            };
            return new Data_Either.Left(new TypeMismatch(_272, tagOf(_273)));
        };
    };
    var readString = unsafeReadPrim("String");
    var readNumber = unsafeReadPrim("Number");
    var readBoolean = unsafeReadPrim("Boolean");
    var readArray = function (_274) {
        if (isArray(_274)) {
            return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_274));
        };
        return new Data_Either.Left(new TypeMismatch("array", tagOf(_274)));
    };
    var parseJSON = function (json) {
        return parseJSONImpl(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(JSONError.create), Data_Either.Right.create, json);
    };
    return {
        TypeMismatch: TypeMismatch, 
        ErrorAtIndex: ErrorAtIndex, 
        ErrorAtProperty: ErrorAtProperty, 
        JSONError: JSONError, 
        readArray: readArray, 
        readNumber: readNumber, 
        readBoolean: readBoolean, 
        readString: readString, 
        isArray: isArray, 
        isUndefined: isUndefined, 
        isNull: isNull, 
        tagOf: tagOf, 
        typeOf: typeOf, 
        unsafeFromForeign: unsafeFromForeign, 
        parseJSON: parseJSON
    };
})();
var PS = PS || {};
PS.Control_Monad_JQuery = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign = PS.Data_Foreign;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var DOM = PS.DOM;
    
  function select(selector) {
    return function () {
      return jQuery(selector);
    };
  }
  ;
    return {
        select: select
    };
})();
var PS = PS || {};
PS.Data_Foreign_Index = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Foreign = PS.Data_Foreign;
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    
  function unsafeReadPropImpl(f, s, key, value) {
    return value == null ? f : s(value[key]);
  }
  ;
    
  function unsafeHasOwnProperty(prop, value) {
    return Object.prototype.hasOwnProperty.call(value, prop);
  }
  ;
    
  function unsafeHasProperty(prop, value) {
    return prop in value;
  }
  ;
    var Index = function ($bang, errorAt, hasOwnProperty, hasProperty) {
        this["!"] = $bang;
        this.errorAt = errorAt;
        this.hasOwnProperty = hasOwnProperty;
        this.hasProperty = hasProperty;
    };
    var $bang = function (dict) {
        return dict["!"];
    };
    var unsafeReadProp = function (k) {
        return function (value) {
            return unsafeReadPropImpl(new Data_Either.Left(new Data_Foreign.TypeMismatch("object", Data_Foreign.typeOf(value))), Prelude.pure(Data_Either.applicativeEither), k, value);
        };
    };
    var prop = unsafeReadProp;
    var hasPropertyImpl = function (_280) {
        return function (_281) {
            if (Data_Foreign.isNull(_281)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_281)) {
                return false;
            };
            if (Data_Foreign.typeOf(_281) === "object" || Data_Foreign.typeOf(_281) === "function") {
                return unsafeHasProperty(_280, _281);
            };
            return false;
        };
    };
    var hasOwnPropertyImpl = function (_278) {
        return function (_279) {
            if (Data_Foreign.isNull(_279)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_279)) {
                return false;
            };
            if (Data_Foreign.typeOf(_279) === "object" || Data_Foreign.typeOf(_279) === "function") {
                return unsafeHasOwnProperty(_278, _279);
            };
            return false;
        };
    };
    var indexString = new Index(Prelude.flip(prop), Data_Foreign.ErrorAtProperty.create, hasOwnPropertyImpl, hasPropertyImpl);
    var hasOwnProperty = function (dict) {
        return dict.hasOwnProperty;
    };
    var errorAt = function (dict) {
        return dict.errorAt;
    };
    return {
        Index: Index, 
        errorAt: errorAt, 
        hasOwnProperty: hasOwnProperty, 
        "!": $bang, 
        prop: prop, 
        indexString: indexString
    };
})();
var PS = PS || {};
PS.Data_Foreign_NullOrUndefined = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign = PS.Data_Foreign;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Either = PS.Data_Either;
    var NullOrUndefined = function (x) {
        return x;
    };
    var runNullOrUndefined = function (_295) {
        return _295;
    };
    var readNullOrUndefined = function (_296) {
        return function (_297) {
            if (Data_Foreign.isNull(_297) || Data_Foreign.isUndefined(_297)) {
                return Prelude.pure(Data_Either.applicativeEither)(Data_Maybe.Nothing.value);
            };
            return Prelude["<$>"](Data_Either.functorEither)(Prelude["<<<"](Prelude.semigroupoidArr)(NullOrUndefined)(Data_Maybe.Just.create))(_296(_297));
        };
    };
    return {
        NullOrUndefined: NullOrUndefined, 
        readNullOrUndefined: readNullOrUndefined, 
        runNullOrUndefined: runNullOrUndefined
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    var Monoid = function (__superclass_Prelude$dotSemigroup_0, mempty) {
        this["__superclass_Prelude.Semigroup_0"] = __superclass_Prelude$dotSemigroup_0;
        this.mempty = mempty;
    };
    var monoidString = new Monoid(function () {
        return Prelude.semigroupString;
    }, "");
    var mempty = function (dict) {
        return dict.mempty;
    };
    return {
        Monoid: Monoid, 
        mempty: mempty, 
        monoidString: monoidString
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Apply = PS.Control_Apply;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Either = PS.Data_Either;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid_Additive = PS.Data_Monoid_Additive;
    var Data_Monoid_Dual = PS.Data_Monoid_Dual;
    var Data_Monoid_Last = PS.Data_Monoid_Last;
    var Data_Monoid_Multiplicative = PS.Data_Monoid_Multiplicative;
    var Data_Tuple = PS.Data_Tuple;
    
  function foldrArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = xs.length - 1; i >= 0; --i) {
          acc = f(xs[i])(acc);
        }
        return acc;
      };
    };
  }
  ;
    
  function foldlArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = 0, len = xs.length; i < len; ++i) {
          acc = f(acc)(xs[i]);
        }
        return acc;
      };
    };
  }
  ;
    var Foldable = function (foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    var foldr = function (dict) {
        return dict.foldr;
    };
    var foldl = function (dict) {
        return dict.foldl;
    };
    var intercalate = function (__dict_Foldable_280) {
        return function (__dict_Monoid_281) {
            return function (sep) {
                return function (xs) {
                    var go = function (_560) {
                        return function (_561) {
                            if (_560.init) {
                                return {
                                    init: false, 
                                    acc: _561
                                };
                            };
                            return {
                                init: false, 
                                acc: Prelude["<>"](__dict_Monoid_281["__superclass_Prelude.Semigroup_0"]())(_560.acc)(Prelude["<>"](__dict_Monoid_281["__superclass_Prelude.Semigroup_0"]())(sep)(_561))
                            };
                        };
                    };
                    return (foldl(__dict_Foldable_280)(go)({
                        init: true, 
                        acc: Data_Monoid.mempty(__dict_Monoid_281)
                    })(xs)).acc;
                };
            };
        };
    };
    var foldableArray = new Foldable(function (__dict_Monoid_292) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_292["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_292))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    return {
        Foldable: Foldable, 
        foldlArray: foldlArray, 
        foldrArray: foldrArray, 
        intercalate: intercalate, 
        foldl: foldl, 
        foldr: foldr, 
        foldableArray: foldableArray
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Either = PS.Data_Either;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid_Additive = PS.Data_Monoid_Additive;
    var Data_Monoid_Dual = PS.Data_Monoid_Dual;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Monoid_Last = PS.Data_Monoid_Last;
    var Data_Monoid_Multiplicative = PS.Data_Monoid_Multiplicative;
    var Traversable = function (__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_325) {
        return function (_576) {
            if (_576.length === 0) {
                return Prelude.pure(__dict_Applicative_325)([  ]);
            };
            if (_576.length >= 1) {
                var _831 = _576.slice(1);
                return Prelude["<*>"](__dict_Applicative_325["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_325["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_576[0]))(sequence(traversableArray)(__dict_Applicative_325)(_831));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_324) {
        return function (_574) {
            return function (_575) {
                if (_575.length === 0) {
                    return Prelude.pure(__dict_Applicative_324)([  ]);
                };
                if (_575.length >= 1) {
                    var _835 = _575.slice(1);
                    return Prelude["<*>"](__dict_Applicative_324["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_324["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_574(_575[0])))(traverse(traversableArray)(__dict_Applicative_324)(_574)(_835));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    return {
        Traversable: Traversable, 
        sequence: sequence, 
        traverse: traverse, 
        traversableArray: traversableArray
    };
})();
var PS = PS || {};
PS.Data_Const = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Contravariant = PS.Data_Contravariant;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Traversable = PS.Data_Traversable;
    var Const = function (x) {
        return x;
    };
    var getConst = function (_601) {
        return _601;
    };
    var functorConst = new Prelude.Functor(function (_611) {
        return function (_612) {
            return _612;
        };
    });
    return {
        Const: Const, 
        getConst: getConst, 
        functorConst: functorConst
    };
})();
var PS = PS || {};
PS.Data_Foreign_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign = PS.Data_Foreign;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array = PS.Data_Array;
    var Data_Foreign_Null = PS.Data_Foreign_Null;
    var Data_Foreign_Undefined = PS.Data_Foreign_Undefined;
    var Data_Foreign_NullOrUndefined = PS.Data_Foreign_NullOrUndefined;
    var Data_Either = PS.Data_Either;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    var IsForeign = function (read) {
        this.read = read;
    };
    var stringIsForeign = new IsForeign(Data_Foreign.readString);
    var read = function (dict) {
        return dict.read;
    };
    var readJSON = function (__dict_IsForeign_348) {
        return function (json) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign.parseJSON(json))(read(__dict_IsForeign_348));
        };
    };
    var readWith = function (__dict_IsForeign_349) {
        return function (f) {
            return function (value) {
                return Data_Either.either(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(f))(Data_Either.Right.create)(read(__dict_IsForeign_349)(value));
            };
        };
    };
    var readProp = function (__dict_IsForeign_350) {
        return function (__dict_Index_351) {
            return function (prop) {
                return function (value) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Index["!"](__dict_Index_351)(value)(prop))(readWith(__dict_IsForeign_350)(Data_Foreign_Index.errorAt(__dict_Index_351)(prop)));
                };
            };
        };
    };
    var numberIsForeign = new IsForeign(Data_Foreign.readNumber);
    var nullOrUndefinedIsForeign = function (__dict_IsForeign_353) {
        return new IsForeign(Data_Foreign_NullOrUndefined.readNullOrUndefined(read(__dict_IsForeign_353)));
    };
    var booleanIsForeign = new IsForeign(Data_Foreign.readBoolean);
    var arrayIsForeign = function (__dict_IsForeign_355) {
        return new IsForeign(function (value) {
            var readElement = function (i) {
                return function (value_1) {
                    return readWith(__dict_IsForeign_355)(Data_Foreign.ErrorAtIndex.create(i))(value_1);
                };
            };
            var readElements = function (arr) {
                return Data_Traversable.sequence(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(Data_Array.zipWith(readElement)(Data_Array.range(0)(Data_Array.length(arr)))(arr));
            };
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign.readArray(value))(readElements);
        });
    };
    return {
        IsForeign: IsForeign, 
        readProp: readProp, 
        readWith: readWith, 
        readJSON: readJSON, 
        read: read, 
        stringIsForeign: stringIsForeign, 
        booleanIsForeign: booleanIsForeign, 
        numberIsForeign: numberIsForeign, 
        arrayIsForeign: arrayIsForeign, 
        nullOrUndefinedIsForeign: nullOrUndefinedIsForeign
    };
})();
var PS = PS || {};
PS.Data_Identity = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Traversable = PS.Data_Traversable;
    var Identity = function (x) {
        return x;
    };
    var runIdentity = function (_631) {
        return _631;
    };
    var functorIdentity = new Prelude.Functor(function (_637) {
        return function (_638) {
            return _637(_638);
        };
    });
    return {
        Identity: Identity, 
        runIdentity: runIdentity, 
        functorIdentity: functorIdentity
    };
})();
var PS = PS || {};
PS.Optic_Getter = (function () {
    "use strict";
    var Data_Profunctor = PS.Data_Profunctor;
    var Data_Const = PS.Data_Const;
    var Prelude = PS.Prelude;
    var Data_Contravariant = PS.Data_Contravariant;
    var Optic_Types = PS.Optic_Types;
    var $up$dot = function (s) {
        return function (asa) {
            return Data_Const.getConst(asa(Data_Const.Const)(s));
        };
    };
    return {
        "^.": $up$dot
    };
})();
var PS = PS || {};
PS.Optic_Lens = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Optic_Types = PS.Optic_Types;
    var lens = function (s2a) {
        return function (s2b2t) {
            return function (__dict_Functor_471) {
                return function (a2fb) {
                    return function (s) {
                        return Prelude["<$>"](__dict_Functor_471)(s2b2t(s))(a2fb(s2a(s)));
                    };
                };
            };
        };
    };
    return {
        lens: lens
    };
})();
var PS = PS || {};
PS.Lib_WebSocket = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Prelude = PS.Prelude;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
  function mkWebSocket(url) {
    return function() {
      return new WebSocket(url)
    }
  }
  ;
    
  function onMessageImpl(socket, callback) {
    return function() {
      socket.onmessage = function(msg) {
        callback(msg.data)()
      }
    }
  }
  ;
    
  function onErrorImpl(socket, callback) {
    return function() {
      socket.onerror = callback
    }
  }
  ;
    
  function onCloseImpl(socket, callback) {
    return function() {
      socket.onclose = callback
    }
  }
  ;
    var onMessage = function (socket) {
        return function (callback) {
            return onMessageImpl(socket, callback);
        };
    };
    var onError = function (socket) {
        return function (callback) {
            return onErrorImpl(socket, callback);
        };
    };
    var onClose = function (socket) {
        return function (callback) {
            return onCloseImpl(socket, callback);
        };
    };
    return {
        onClose: onClose, 
        onCloseImpl: onCloseImpl, 
        onError: onError, 
        onErrorImpl: onErrorImpl, 
        onMessage: onMessage, 
        onMessageImpl: onMessageImpl, 
        mkWebSocket: mkWebSocket
    };
})();
var PS = PS || {};
PS.Optic_Setter = (function () {
    "use strict";
    var Data_Profunctor = PS.Data_Profunctor;
    var Data_Contravariant = PS.Data_Contravariant;
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Optic_Internal_Setter = PS.Optic_Internal_Setter;
    var Data_Maybe = PS.Data_Maybe;
    var Optic_Types = PS.Optic_Types;
    var set = function (stab) {
        return function (b) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.runIdentity)(stab(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.Identity)(Prelude["const"](b))));
        };
    };
    var $dot$tilde = set;
    return {
        set: set, 
        ".~": $dot$tilde
    };
})();
var PS = PS || {};
PS.Optic_Core = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Optic_Getter = PS.Optic_Getter;
    var Optic_Lens = PS.Optic_Lens;
    var Optic_Prism = PS.Optic_Prism;
    var Optic_Setter = PS.Optic_Setter;
    var Optic_Types = PS.Optic_Types;
    var $up$dot = Optic_Getter["^."];
    var $dot$tilde = Optic_Setter[".~"];
    var lens = Optic_Lens.lens;
    return {
        ".~": $dot$tilde, 
        lens: lens, 
        "^.": $up$dot
    };
})();
var PS = PS || {};
PS.Types = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Data_Array = PS.Data_Array;
    var AtUsername = (function () {
        function AtUsername(value0) {
            this.value0 = value0;
        };
        AtUsername.create = function (value0) {
            return new AtUsername(value0);
        };
        return AtUsername;
    })();
    var Link = (function () {
        function Link(value0) {
            this.value0 = value0;
        };
        Link.create = function (value0) {
            return new Link(value0);
        };
        return Link;
    })();
    var PlainText = (function () {
        function PlainText(value0) {
            this.value0 = value0;
        };
        PlainText.create = function (value0) {
            return new PlainText(value0);
        };
        return PlainText;
    })();
    var Hashtag = (function () {
        function Hashtag(value0) {
            this.value0 = value0;
        };
        Hashtag.create = function (value0) {
            return new Hashtag(value0);
        };
        return Hashtag;
    })();
    var Retweet = (function () {
        function Retweet(value0) {
            this.value0 = value0;
        };
        Retweet.create = function (value0) {
            return new Retweet(value0);
        };
        return Retweet;
    })();
    var Spaces = (function () {
        function Spaces(value0) {
            this.value0 = value0;
        };
        Spaces.create = function (value0) {
            return new Spaces(value0);
        };
        return Spaces;
    })();
    var Unparsable = (function () {
        function Unparsable(value0) {
            this.value0 = value0;
        };
        Unparsable.create = function (value0) {
            return new Unparsable(value0);
        };
        return Unparsable;
    })();
    var $$Error = (function () {
        function Error(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        Error.create = function (value0) {
            return function (value1) {
                return new Error(value0, value1);
            };
        };
        return Error;
    })();
    var Success = (function () {
        function Success(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        Success.create = function (value0) {
            return function (value1) {
                return new Success(value0, value1);
            };
        };
        return Success;
    })();
    var Other = (function () {
        function Other(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        Other.create = function (value0) {
            return function (value1) {
                return new Other(value0, value1);
            };
        };
        return Other;
    })();
    var User = (function () {
        function User(value0) {
            this.value0 = value0;
        };
        User.create = function (value0) {
            return new User(value0);
        };
        return User;
    })();
    var UserInfo = (function () {
        function UserInfo(value0) {
            this.value0 = value0;
        };
        UserInfo.create = function (value0) {
            return new UserInfo(value0);
        };
        return UserInfo;
    })();
    var EntityUrl = (function () {
        function EntityUrl(value0) {
            this.value0 = value0;
        };
        EntityUrl.create = function (value0) {
            return new EntityUrl(value0);
        };
        return EntityUrl;
    })();
    var EntityMediaSize = (function () {
        function EntityMediaSize(value0) {
            this.value0 = value0;
        };
        EntityMediaSize.create = function (value0) {
            return new EntityMediaSize(value0);
        };
        return EntityMediaSize;
    })();
    var EntityMediaSizes = (function () {
        function EntityMediaSizes(value0) {
            this.value0 = value0;
        };
        EntityMediaSizes.create = function (value0) {
            return new EntityMediaSizes(value0);
        };
        return EntityMediaSizes;
    })();
    var EntityMedia = (function () {
        function EntityMedia(value0) {
            this.value0 = value0;
        };
        EntityMedia.create = function (value0) {
            return new EntityMedia(value0);
        };
        return EntityMedia;
    })();
    var EntityHashtag = (function () {
        function EntityHashtag(value0) {
            this.value0 = value0;
        };
        EntityHashtag.create = function (value0) {
            return new EntityHashtag(value0);
        };
        return EntityHashtag;
    })();
    var Entities = (function () {
        function Entities(value0) {
            this.value0 = value0;
        };
        Entities.create = function (value0) {
            return new Entities(value0);
        };
        return Entities;
    })();
    var ContextMenu = (function () {
        function ContextMenu(value0) {
            this.value0 = value0;
        };
        ContextMenu.create = function (value0) {
            return new ContextMenu(value0);
        };
        return ContextMenu;
    })();
    var Author = (function () {
        function Author(value0) {
            this.value0 = value0;
        };
        Author.create = function (value0) {
            return new Author(value0);
        };
        return Author;
    })();
    var Tweet = (function () {
        function Tweet(value0) {
            this.value0 = value0;
        };
        Tweet.create = function (value0) {
            return new Tweet(value0);
        };
        return Tweet;
    })();
    var CurrentFeed = function (x) {
        return x;
    };
    var NewFeed = function (x) {
        return x;
    };
    var OldFeed = function (x) {
        return x;
    };
    var BFeed = (function () {
        function BFeed(value0) {
            this.value0 = value0;
        };
        BFeed.create = function (value0) {
            return new BFeed(value0);
        };
        return BFeed;
    })();
    var WriteInput = (function () {
        function WriteInput(value0) {
            this.value0 = value0;
        };
        WriteInput.create = function (value0) {
            return new WriteInput(value0);
        };
        return WriteInput;
    })();
    var ResponseSuccess = (function () {
        function ResponseSuccess(value0) {
            this.value0 = value0;
        };
        ResponseSuccess.create = function (value0) {
            return new ResponseSuccess(value0);
        };
        return ResponseSuccess;
    })();
    var ResponseError = (function () {
        function ResponseError(value0) {
            this.value0 = value0;
        };
        ResponseError.create = function (value0) {
            return new ResponseError(value0);
        };
        return ResponseError;
    })();
    var ResponseTimeout = (function () {
        function ResponseTimeout(value0) {
            this.value0 = value0;
        };
        ResponseTimeout.create = function (value0) {
            return new ResponseTimeout(value0);
        };
        return ResponseTimeout;
    })();
    var ResponseUserinfo = (function () {
        function ResponseUserinfo(value0) {
            this.value0 = value0;
        };
        ResponseUserinfo.create = function (value0) {
            return new ResponseUserinfo(value0);
        };
        return ResponseUserinfo;
    })();
    var AFeed = (function () {
        function AFeed(value0) {
            this.value0 = value0;
        };
        AFeed.create = function (value0) {
            return new AFeed(value0);
        };
        return AFeed;
    })();
    var State = (function () {
        function State(value0) {
            this.value0 = value0;
        };
        State.create = function (value0) {
            return new State(value0);
        };
        return State;
    })();
    var semigroupOldFeed = new Prelude.Semigroup(function (_700) {
        return function (_701) {
            return OldFeed(Prelude["++"](Data_Array.semigroupArray)(_700)(_701));
        };
    });
    var semigroupNewFeed = new Prelude.Semigroup(function (_698) {
        return function (_699) {
            return NewFeed(Prelude["++"](Data_Array.semigroupArray)(_698)(_699));
        };
    });
    return {
        ResponseSuccess: ResponseSuccess, 
        ResponseError: ResponseError, 
        ResponseTimeout: ResponseTimeout, 
        ResponseUserinfo: ResponseUserinfo, 
        User: User, 
        EntityMediaSizes: EntityMediaSizes, 
        EntityMediaSize: EntityMediaSize, 
        EntityMedia: EntityMedia, 
        EntityHashtag: EntityHashtag, 
        EntityUrl: EntityUrl, 
        Entities: Entities, 
        Tweet: Tweet, 
        Author: Author, 
        AtUsername: AtUsername, 
        Link: Link, 
        PlainText: PlainText, 
        Hashtag: Hashtag, 
        Retweet: Retweet, 
        Spaces: Spaces, 
        Unparsable: Unparsable, 
        State: State, 
        BFeed: BFeed, 
        AFeed: AFeed, 
        UserInfo: UserInfo, 
        WriteInput: WriteInput, 
        ContextMenu: ContextMenu, 
        "Error": $$Error, 
        Success: Success, 
        Other: Other, 
        NewFeed: NewFeed, 
        CurrentFeed: CurrentFeed, 
        OldFeed: OldFeed, 
        semigroupNewFeed: semigroupNewFeed, 
        semigroupOldFeed: semigroupOldFeed
    };
})();
var PS = PS || {};
PS.UI_Types = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Types = PS.Types;
    var React_Types = PS.React_Types;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var AsHtml = function (asHtml) {
        this.asHtml = asHtml;
    };
    var asHtml = function (dict) {
        return dict.asHtml;
    };
    return {
        AsHtml: AsHtml, 
        asHtml: asHtml
    };
})();
var PS = PS || {};
PS.Rx_Observable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var DOM = PS.DOM;
    
  function subscribe(ob) {
    return function(f) {
      return function() {
        return ob.subscribe(function(value) {
          f(value)();
        });
      };
    };
  }
  ;
    
  function map(f) {
    return function(ob) {
      return ob.map(f);
    };
  }
  ;
    var functorObservable = new Prelude.Functor(map);
    return {
        subscribe: subscribe, 
        functorObservable: functorObservable
    };
})();
var PS = PS || {};
PS.Rx_JQuery = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var DOM = PS.DOM;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Data_Foreign = PS.Data_Foreign;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Rx_Observable = PS.Rx_Observable;
    
  function onAsObservable(evt) {
    return function(ob) {
      return function() {
        return ob.onAsObservable(evt);
      }
    }
  }
  ;
    return {
        onAsObservable: onAsObservable
    };
})();
var PS = PS || {};
PS.Utils = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Rx_Observable = PS.Rx_Observable;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Rx_JQuery = PS.Rx_JQuery;
    var Debug_Trace = PS.Debug_Trace;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var DOM = PS.DOM;
    var Data_DOM_Simple_Types = PS.Data_DOM_Simple_Types;
    var Data_DOM_Simple_Element = PS.Data_DOM_Simple_Element;
    var Types = PS.Types;
    var Data_Either = PS.Data_Either;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Array = PS.Data_Array;
    var React_Types = PS.React_Types;
    var Network_XHR = PS.Network_XHR;
    var Network_XHR_Internal = PS.Network_XHR_Internal;
    var Network_XHR_Types = PS.Network_XHR_Types;
    function toString(a){
        console.log('toString:', a);
        return a.toString();
    } ;
    function scrollToTop() {
           console.log('scroll to top');
           window.scroll(0,0);
           return undefined;
    };
    
    function rioGet(url){
        return Rx.Observable.create(function(observer){
            var ok = function(result) { observer.onNext(JSON.stringify(result)) },
                nok = function(error) { observer.onError(JSON.stringify(error)) };
            jQuery.ajax(
                url,
                { type: 'GET'
                , success: ok
                , error: nok
                });
        });
    }
    ;
    
    function rioPost(url){
        return function(data){
            return Rx.Observable.create(function(observer){
                var ok = function(result) { observer.onNext(JSON.stringify(result)) },
                    nok = function(error) { observer.onError(JSON.stringify(error)) };
                jQuery.ajax(
                    url,
                    { type: 'POST'
                    , data: data
                    , success: ok
                    , error: nok
                    });
            });
        }
    }
    ;
    
    function filterRx(f){
        return function(observable) {
            return observable.filter(f)
        }
    }
    ;
    
    function value(el) {
      return el.value;
    };
    function setFocus(id) { return function() { jQuery('#' + id).focus(); }};
    function which(ev) { return ev.which; };
    
    function forkPostpone(f) {
        return function(delay) {
            return function() {
                console.log("postponing ", f, delay)
                setTimeout(f, delay);
            }
        }
    }
    ;
    
    function splitAt(as) {
        return function(idx) {
            return [as.slice(0, idx), as.slice(idx)]
        }
    }
    ;
    
    function getNewObservable(x) {
        return new Rx.Subject()
    }
    ;
    
    function publishToObservable(obs){
        return function (val) {
                obs.onNext(val)
        }
    }
    ;
    
    function setProps(view) {
        return function(props) {
            return function(){
                view.setProps(props)
                return null
            }
        }
    }
    ;
    
    function showuuid(ident) {
      return ident.toString();
    };
    
    function runUUID(UUID) {
      return UUID();
    };
    
    function getUUID() {
      var i, itoh, s, t, _i;
      s = [];
      itoh = '0123456789ABCDEF'.split('');
      s = (function() {
        var _i, _results;
        _results = [];
        for (i = _i = 0; _i <= 35; i = ++_i) {
          _results.push(Math.floor(Math.random() * 0x10));
        }
        return _results;
      })();
      t = (new Date()).getTime() & 0x7FFFFFFF;
      for (i = _i = 0; _i <= 3; i = ++_i) {
        s[i] = t & 0xF;
        t >>= 8;
      }
      s[14] = 4;
      s[19] = (s[19] & 0x3) | 0x8;
      s = (function() {
        var _j, _len, _results;
        _results = [];
        for (_j = 0, _len = s.length; _j < _len; _j++) {
          i = s[_j];
          _results.push(itoh[s[i]]);
        }
        return _results;
      })();
      s[8] = s[13] = s[18] = s[23] = '-';
      return s.join('');
    };
    ;
    
    function callEventHandler(f){
        return function(e){ return f(e)() }
    }
    ;
    
    function stopPropagation(e) { return function() {e.stopPropagation(); e.preventDefault(); } }
    ;
    
    function stringReplace(src){
        return function(pattern) {
            return function(replacement){
                return src.replace(pattern, replacement)
            }
        }
    }
    ;
    var Insert = (function () {
        function Insert() {

        };
        Insert.value = new Insert();
        return Insert;
    })();
    var Escape = (function () {
        function Escape() {

        };
        Escape.value = new Escape();
        return Escape;
    })();
    var Enter = (function () {
        function Enter() {

        };
        Enter.value = new Enter();
        return Enter;
    })();
    var Delete = (function () {
        function Delete() {

        };
        Delete.value = new Delete();
        return Delete;
    })();
    var F2 = (function () {
        function F2() {

        };
        F2.value = new F2();
        return F2;
    })();
    var F4 = (function () {
        function F4() {

        };
        F4.value = new F4();
        return F4;
    })();
    var F5 = (function () {
        function F5() {

        };
        F5.value = new F5();
        return F5;
    })();
    var UnknownKey = (function () {
        function UnknownKey(value0) {
            this.value0 = value0;
        };
        UnknownKey.create = function (value0) {
            return new UnknownKey(value0);
        };
        return UnknownKey;
    })();
    var $tilde$greater = Rx_Observable.subscribe;
    var keyEventToKeyCode = function (_707) {
        if (which(_707) === 13) {
            return Enter.value;
        };
        if (which(_707) === 27) {
            return Escape.value;
        };
        if (which(_707) === 45) {
            return Insert.value;
        };
        if (which(_707) === 46) {
            return Delete.value;
        };
        if (which(_707) === 113) {
            return F2.value;
        };
        if (which(_707) === 115) {
            return F4.value;
        };
        if (which(_707) === 116) {
            return F5.value;
        };
        return UnknownKey.create(which(_707));
    };
    var eqUUID = new Prelude.Eq(function (ident) {
        return function (ident$prime) {
            return !Prelude["=="](eqUUID)(ident)(ident$prime);
        };
    }, function (ident) {
        return function (ident$prime) {
            return showuuid(ident) === showuuid(ident$prime);
        };
    });
    var eqKeyCode = new Prelude.Eq(function (a) {
        return function (b) {
            return !Prelude["=="](eqKeyCode)(a)(b);
        };
    }, function (_708) {
        return function (_709) {
            if (_708 instanceof Insert && _709 instanceof Insert) {
                return true;
            };
            if (_708 instanceof Escape && _709 instanceof Escape) {
                return true;
            };
            if (_708 instanceof Enter && _709 instanceof Enter) {
                return true;
            };
            if (_708 instanceof Delete && _709 instanceof Delete) {
                return true;
            };
            if (_708 instanceof F2 && _709 instanceof F2) {
                return true;
            };
            if (_708 instanceof F4 && _709 instanceof F4) {
                return true;
            };
            if (_708 instanceof F5 && _709 instanceof F5) {
                return true;
            };
            return false;
        };
    });
    return {
        Insert: Insert, 
        Escape: Escape, 
        Enter: Enter, 
        Delete: Delete, 
        F2: F2, 
        F4: F4, 
        F5: F5, 
        UnknownKey: UnknownKey, 
        stringReplace: stringReplace, 
        stopPropagation: stopPropagation, 
        callEventHandler: callEventHandler, 
        getUUID: getUUID, 
        runUUID: runUUID, 
        showuuid: showuuid, 
        keyEventToKeyCode: keyEventToKeyCode, 
        setProps: setProps, 
        publishToObservable: publishToObservable, 
        getNewObservable: getNewObservable, 
        splitAt: splitAt, 
        forkPostpone: forkPostpone, 
        which: which, 
        setFocus: setFocus, 
        value: value, 
        filterRx: filterRx, 
        "~>": $tilde$greater, 
        rioPost: rioPost, 
        rioGet: rioGet, 
        scrollToTop: scrollToTop, 
        toString: toString, 
        eqKeyCode: eqKeyCode, 
        eqUUID: eqUUID
    };
})();
var PS = PS || {};
PS.Config = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var socketUrl = "ws://localhost:3000";
    var historyUrl = "/history";
    return {
        socketUrl: socketUrl, 
        historyUrl: historyUrl
    };
})();
var PS = PS || {};
PS.Core = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign_Class = PS.Data_Foreign_Class;
    var Data_Foreign_NullOrUndefined = PS.Data_Foreign_NullOrUndefined;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    var Utils = PS.Utils;
    var Optic_Core = PS.Optic_Core;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Debug_Trace = PS.Debug_Trace;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Data_Foreign = PS.Data_Foreign;
    var DOM = PS.DOM;
    var Network_XHR = PS.Network_XHR;
    var Network_XHR_Internal = PS.Network_XHR_Internal;
    var Network_XHR_Types = PS.Network_XHR_Types;
    var Data_Either = PS.Data_Either;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Maybe = PS.Data_Maybe;
    var Types = PS.Types;
    var Config = PS.Config;
    var Data_Identity = PS.Data_Identity;
    var Data_Array = PS.Data_Array;
    var Data_Const = PS.Data_Const;
    
    function setTitle(a) {
      return function() {
        document.title = a;
        return undefined;
      }
    }
    ;
    var writeInputVisibleL = function (__dict_Functor_504) {
        return Optic_Core.lens(function (_718) {
            return _718.value0.visible;
        })(function (_719) {
            return function (v) {
                return new Types.WriteInput((function () {
                    var _852 = {};
                    for (var _853 in _719.value0) {
                        if (_719.value0.hasOwnProperty(_853)) {
                            _852[_853] = _719.value0[_853];
                        };
                    };
                    _852.visible = v;
                    return _852;
                })());
            };
        })(__dict_Functor_504);
    };
    var writeInputValueL = function (__dict_Functor_505) {
        return Optic_Core.lens(function (_720) {
            return _720.value0.value;
        })(function (_721) {
            return function (v) {
                return new Types.WriteInput((function () {
                    var _858 = {};
                    for (var _859 in _721.value0) {
                        if (_721.value0.hasOwnProperty(_859)) {
                            _858[_859] = _721.value0[_859];
                        };
                    };
                    _858.value = v;
                    return _858;
                })());
            };
        })(__dict_Functor_505);
    };
    var writeInputL = function (__dict_Functor_506) {
        return Optic_Core.lens(function (_724) {
            return _724.value0.writeInput;
        })(function (_725) {
            return function (wi) {
                return new Types.State((function () {
                    var _864 = {};
                    for (var _865 in _725.value0) {
                        if (_725.value0.hasOwnProperty(_865)) {
                            _864[_865] = _725.value0[_865];
                        };
                    };
                    _864.writeInput = wi;
                    return _864;
                })());
            };
        })(__dict_Functor_506);
    };
    var writeInputDisabledL = function (__dict_Functor_507) {
        return Optic_Core.lens(function (_716) {
            return _716.value0.disabled;
        })(function (_717) {
            return function (v) {
                return new Types.WriteInput((function () {
                    var _870 = {};
                    for (var _871 in _717.value0) {
                        if (_717.value0.hasOwnProperty(_871)) {
                            _870[_871] = _717.value0[_871];
                        };
                    };
                    _870.disabled = v;
                    return _870;
                })());
            };
        })(__dict_Functor_507);
    };
    var userInfoVisibleL = function (__dict_Functor_508) {
        return Optic_Core.lens(function (_712) {
            return _712.value0.visible;
        })(function (_713) {
            return function (v) {
                return new Types.UserInfo((function () {
                    var _876 = {};
                    for (var _877 in _713.value0) {
                        if (_713.value0.hasOwnProperty(_877)) {
                            _876[_877] = _713.value0[_877];
                        };
                    };
                    _876.visible = v;
                    return _876;
                })());
            };
        })(__dict_Functor_508);
    };
    var userInfoUserdataL = function (__dict_Functor_509) {
        return Optic_Core.lens(function (_714) {
            return _714.value0.userdata;
        })(function (_715) {
            return function (d) {
                return new Types.UserInfo((function () {
                    var _882 = {};
                    for (var _883 in _715.value0) {
                        if (_715.value0.hasOwnProperty(_883)) {
                            _882[_883] = _715.value0[_883];
                        };
                    };
                    _882.userdata = d;
                    return _882;
                })());
            };
        })(__dict_Functor_509);
    };
    var userInfoL = function (__dict_Functor_510) {
        return Optic_Core.lens(function (_710) {
            return _710.value0.userInfo;
        })(function (_711) {
            return function (ui) {
                return new Types.State((function () {
                    var _888 = {};
                    for (var _889 in _711.value0) {
                        if (_711.value0.hasOwnProperty(_889)) {
                            _888[_889] = _711.value0[_889];
                        };
                    };
                    _888.userInfo = ui;
                    return _888;
                })());
            };
        })(__dict_Functor_510);
    };
    var toTweetToken = function (_740) {
        if (_740 === "AtUsername") {
            return Types.AtUsername.create;
        };
        if (_740 === "Link") {
            return Types.Link.create;
        };
        if (_740 === "PlainText") {
            return Types.PlainText.create;
        };
        if (_740 === "Hashtag") {
            return Types.Hashtag.create;
        };
        if (_740 === "Spaces") {
            return Types.Spaces.create;
        };
        if (_740 === "Unparsable") {
            return Types.Unparsable.create;
        };
        throw new Error("Failed pattern match");
    };
    
    /**
     * ------------------------------------------------------------------------------
     */
    var successM = function (m) {
        return new Types.Success(m, Utils.runUUID(Utils.getUUID));
    };
    var readState = Control_Monad_Eff_Ref.readRef;
    var oldFeedL = function (__dict_Functor_511) {
        return Optic_Core.lens(function (_736) {
            return _736.value0.oldFeed;
        })(function (_737) {
            return function (ts) {
                return new Types.AFeed((function () {
                    var _895 = {};
                    for (var _896 in _737.value0) {
                        if (_737.value0.hasOwnProperty(_896)) {
                            _895[_896] = _737.value0[_896];
                        };
                    };
                    _895.oldFeed = ts;
                    return _895;
                })());
            };
        })(__dict_Functor_511);
    };
    var newFeedL = function (__dict_Functor_512) {
        return Optic_Core.lens(function (_734) {
            return _734.value0.newFeed;
        })(function (_735) {
            return function (ts) {
                return new Types.AFeed((function () {
                    var _901 = {};
                    for (var _902 in _735.value0) {
                        if (_735.value0.hasOwnProperty(_902)) {
                            _901[_902] = _735.value0[_902];
                        };
                    };
                    _901.newFeed = ts;
                    return _901;
                })());
            };
        })(__dict_Functor_512);
    };
    var messagesL = function (__dict_Functor_513) {
        return Optic_Core.lens(function (_726) {
            return _726.value0.errors;
        })(function (_727) {
            return function (msgs) {
                return new Types.State((function () {
                    var _907 = {};
                    for (var _908 in _727.value0) {
                        if (_727.value0.hasOwnProperty(_908)) {
                            _907[_908] = _727.value0[_908];
                        };
                    };
                    _907.errors = msgs;
                    return _907;
                })());
            };
        })(__dict_Functor_513);
    };
    var isForeignUser = new Data_Foreign_Class.IsForeign(function (rawObj) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("contributors_enabled")(rawObj))(function (_75) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("created_at")(rawObj))(function (_74) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("default_profile")(rawObj))(function (_73) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("default_profile_image")(rawObj))(function (_72) {
                        return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("description")(rawObj)))(function (_71) {
                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("favourites_count")(rawObj))(function (_70) {
                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.booleanIsForeign))(Data_Foreign_Index.indexString)("follow_request_sent")(rawObj)))(function (_69) {
                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.booleanIsForeign))(Data_Foreign_Index.indexString)("following")(rawObj)))(function (_68) {
                                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("followers_count")(rawObj))(function (_67) {
                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("friends_count")(rawObj))(function (_66) {
                                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("geo_enabled")(rawObj))(function (_65) {
                                                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("id")(rawObj))(function (_64) {
                                                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("is_translator")(rawObj))(function (_63) {
                                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("lang")(rawObj))(function (_62) {
                                                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("listed_count")(rawObj))(function (_61) {
                                                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("location")(rawObj)))(function (_60) {
                                                                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("name")(rawObj))(function (_59) {
                                                                            return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.booleanIsForeign))(Data_Foreign_Index.indexString)("notifications")(rawObj)))(function (_58) {
                                                                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_background_color")(rawObj)))(function (_57) {
                                                                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_background_image_url")(rawObj)))(function (_56) {
                                                                                        return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_background_image_url_https")(rawObj)))(function (_55) {
                                                                                            return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.booleanIsForeign))(Data_Foreign_Index.indexString)("profile_background_tile")(rawObj)))(function (_54) {
                                                                                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_banner_url")(rawObj)))(function (_53) {
                                                                                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_image_url")(rawObj)))(function (_52) {
                                                                                                        return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("profile_image_url_https")(rawObj)))(function (_51) {
                                                                                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("profile_link_color")(rawObj))(function (_50) {
                                                                                                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("profile_sidebar_border_color")(rawObj))(function (_49) {
                                                                                                                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("profile_sidebar_fill_color")(rawObj))(function (_48) {
                                                                                                                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("profile_text_color")(rawObj))(function (_47) {
                                                                                                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("profile_use_background_image")(rawObj))(function (_46) {
                                                                                                                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("protected")(rawObj))(function (_45) {
                                                                                                                                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("screen_name")(rawObj))(function (_44) {
                                                                                                                                        return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.booleanIsForeign))(Data_Foreign_Index.indexString)("show_all_inline_media")(rawObj)))(function (_43) {
                                                                                                                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("statuses_count")(rawObj))(function (_42) {
                                                                                                                                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("time_zone")(rawObj)))(function (_41) {
                                                                                                                                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("url")(rawObj)))(function (_40) {
                                                                                                                                                        return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.numberIsForeign))(Data_Foreign_Index.indexString)("utc_offset")(rawObj)))(function (_39) {
                                                                                                                                                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("verified")(rawObj))(function (_38) {
                                                                                                                                                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("withheld_in_countries")(rawObj)))(function (_37) {
                                                                                                                                                                    return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.stringIsForeign))(Data_Foreign_Index.indexString)("withheld_scope")(rawObj)))(function (_36) {
                                                                                                                                                                        return Prelude["return"](Data_Either.monadEither)(new Types.User({
                                                                                                                                                                            userContributorsEnabled: _75, 
                                                                                                                                                                            userCreatedAt: _74, 
                                                                                                                                                                            userDefaultProfile: _73, 
                                                                                                                                                                            userDefaultProfileImage: _72, 
                                                                                                                                                                            userDescription: _71, 
                                                                                                                                                                            userFavoritesCount: _70, 
                                                                                                                                                                            userFollowRequestSent: _69, 
                                                                                                                                                                            userFollowing: _68, 
                                                                                                                                                                            userFollowersCount: _67, 
                                                                                                                                                                            userFriendsCount: _66, 
                                                                                                                                                                            userGeoEnabled: _65, 
                                                                                                                                                                            userId: _64, 
                                                                                                                                                                            userIsTranslator: _63, 
                                                                                                                                                                            userLang: _62, 
                                                                                                                                                                            userListedCount: _61, 
                                                                                                                                                                            userLocation: _60, 
                                                                                                                                                                            userName: _59, 
                                                                                                                                                                            userNotifications: _58, 
                                                                                                                                                                            userProfileBackgroundColor: _57, 
                                                                                                                                                                            userProfileBackgroundImageURL: _56, 
                                                                                                                                                                            userProfileBackgroundImageURLHttps: _55, 
                                                                                                                                                                            userProfileBackgroundTile: _54, 
                                                                                                                                                                            userProfileBannerURL: _53, 
                                                                                                                                                                            userProfileImageURL: _52, 
                                                                                                                                                                            userProfileImageURLHttps: _51, 
                                                                                                                                                                            userProfileLinkColor: _50, 
                                                                                                                                                                            userProfileSidebarBorderColor: _49, 
                                                                                                                                                                            userProfileSidebarFillColor: _48, 
                                                                                                                                                                            userProfileTextColor: _47, 
                                                                                                                                                                            userProfileUseBackgroundImage: _46, 
                                                                                                                                                                            userProtected: _45, 
                                                                                                                                                                            userScreenName: _44, 
                                                                                                                                                                            userShowAllInlineMedia: _43, 
                                                                                                                                                                            userStatusesCount: _42, 
                                                                                                                                                                            userTimeZone: _41, 
                                                                                                                                                                            userURL: _40, 
                                                                                                                                                                            userUtcOffset: _39, 
                                                                                                                                                                            userVerified: _38, 
                                                                                                                                                                            userWithheldInCountries: _37, 
                                                                                                                                                                            userWithheldScope: _36
                                                                                                                                                                        }));
                                                                                                                                                                    });
                                                                                                                                                                });
                                                                                                                                                            });
                                                                                                                                                        });
                                                                                                                                                    });
                                                                                                                                                });
                                                                                                                                            });
                                                                                                                                        });
                                                                                                                                    });
                                                                                                                                });
                                                                                                                            });
                                                                                                                        });
                                                                                                                    });
                                                                                                                });
                                                                                                            });
                                                                                                        });
                                                                                                    });
                                                                                                });
                                                                                            });
                                                                                        });
                                                                                    });
                                                                                });
                                                                            });
                                                                        });
                                                                    });
                                                                });
                                                            });
                                                        });
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    });
    var isForeignTweetElement = new Data_Foreign_Class.IsForeign(function (data_) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("type")(data_))(function (_77) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("value")(data_))(function (_76) {
                return Prelude["return"](Data_Either.monadEither)(toTweetToken(_77)(_76));
            });
        });
    });
    var isForeignMediaSize = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("h")(x))(function (_116) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("w")(x))(function (_115) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("resize")(x))(function (_114) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.EntityMediaSize({
                        h: _116, 
                        w: _115, 
                        resize: _114
                    }));
                });
            });
        });
    });
    var isForeignMediaSizes = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignMediaSize)(Data_Foreign_Index.indexString)("thumb")(x))(function (_120) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignMediaSize)(Data_Foreign_Index.indexString)("large")(x))(function (_119) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignMediaSize)(Data_Foreign_Index.indexString)("medium")(x))(function (_118) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignMediaSize)(Data_Foreign_Index.indexString)("small")(x))(function (_117) {
                        return Prelude["return"](Data_Either.monadEither)(new Types.EntityMediaSizes({
                            thumb: _120, 
                            large: _119, 
                            medium: _118, 
                            small: _117
                        }));
                    });
                });
            });
        });
    });
    var isForeignMedia = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("type")(x))(function (_113) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(Data_Foreign_Class.numberIsForeign))(Data_Foreign_Index.indexString)("indices")(x))(function (_112) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("url")(x))(function (_111) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("media_url")(x))(function (_110) {
                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("display_url")(x))(function (_109) {
                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("expanded_url")(x))(function (_108) {
                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignMediaSizes)(Data_Foreign_Index.indexString)("sizes")(x))(function (_107) {
                                    return Prelude["return"](Data_Either.monadEither)(new Types.EntityMedia({
                                        mType: _113, 
                                        mIndices: _112, 
                                        mUrl: _111, 
                                        mMediaUrl: _110, 
                                        mDisplayUrl: _109, 
                                        mExpandedUrl: _108, 
                                        mSizes: _107
                                    }));
                                });
                            });
                        });
                    });
                });
            });
        });
    });
    var isForeignHashtag = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("text")(x))(function (_106) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(Data_Foreign_Class.numberIsForeign))(Data_Foreign_Index.indexString)("indices")(x))(function (_105) {
                return Prelude["return"](Data_Either.monadEither)(new Types.EntityHashtag({
                    hText: _106, 
                    hIndices: _105
                }));
            });
        });
    });
    var isForeignEntityUrl = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("expanded_url")(x))(function (_104) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("url")(x))(function (_103) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(Data_Foreign_Class.numberIsForeign))(Data_Foreign_Index.indexString)("indices")(x))(function (_102) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.EntityUrl({
                        eExpandedUrl: _104, 
                        eUrl: _103, 
                        eIndices: _102
                    }));
                });
            });
        });
    });
    var isForeignEntities = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(isForeignEntityUrl))(Data_Foreign_Index.indexString)("urls")(x))(function (_101) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(isForeignHashtag))(Data_Foreign_Index.indexString)("hashtags")(x))(function (_100) {
                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(Data_Foreign_Class.arrayIsForeign(isForeignMedia)))(Data_Foreign_Index.indexString)("media")(x)))(function (_99) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.Entities({
                        urls: _101, 
                        hashtags: _100, 
                        media: _99
                    }));
                });
            });
        });
    });
    var isForeignAuthor = new Data_Foreign_Class.IsForeign(function (data_) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("name")(data_))(function (_82) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("authorId")(data_))(function (_81) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("screen_name")(data_))(function (_80) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.booleanIsForeign)(Data_Foreign_Index.indexString)("default_profile_image")(data_))(function (_79) {
                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("profile_image_url")(data_))(function (_78) {
                            return Prelude["return"](Data_Either.monadEither)(new Types.Author({
                                name: _82, 
                                authorId: _81, 
                                screen_name: _80, 
                                default_profile_image: _79, 
                                profile_image_url: _78
                            }));
                        });
                    });
                });
            });
        });
    });
    var isForeignTweet = new Data_Foreign_Class.IsForeign(function (x) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(isForeignTweetElement))(Data_Foreign_Index.indexString)("text")(x))(function (_89) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("created_at")(x))(function (_88) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.numberIsForeign)(Data_Foreign_Index.indexString)("id")(x))(function (_87) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("id_str")(x))(function (_86) {
                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignAuthor)(Data_Foreign_Index.indexString)("user")(x))(function (_85) {
                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignEntities)(Data_Foreign_Index.indexString)("entities")(x))(function (_84) {
                                return Prelude[">>="](Data_Either.bindEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Foreign_NullOrUndefined.runNullOrUndefined)(Data_Foreign_Class.readProp(Data_Foreign_Class.nullOrUndefinedIsForeign(isForeignTweet))(Data_Foreign_Index.indexString)("retweet")(x)))(function (_83) {
                                    return Prelude["return"](Data_Either.monadEither)(new Types.Tweet({
                                        text: _89, 
                                        created_at: _88, 
                                        id: _87, 
                                        id_str: _86, 
                                        user: _85, 
                                        entities: _84, 
                                        retweet: _83
                                    }));
                                });
                            });
                        });
                    });
                });
            });
        });
    });
    var readX = function (_741) {
        if (Data_Foreign_Index.hasOwnProperty(Data_Foreign_Index.indexString)("errTitle")(_741)) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("errMessage")(_741))(function (_91) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("errTitle")(_741))(function (_90) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.ResponseError({
                        errTitle: _90, 
                        errMessage: _91
                    }));
                });
            });
        };
        if (Data_Foreign_Index.hasOwnProperty(Data_Foreign_Index.indexString)("okTitle")(_741)) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.arrayIsForeign(isForeignTweet))(Data_Foreign_Index.indexString)("okTweets")(_741))(function (_93) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("okTitle")(_741))(function (_92) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.ResponseSuccess({
                        okTitle: _92, 
                        okTweets: _93
                    }));
                });
            });
        };
        if (Data_Foreign_Index.hasOwnProperty(Data_Foreign_Index.indexString)("toTitle")(_741)) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("toMessage")(_741))(function (_95) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("toTitle")(_741))(function (_94) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.ResponseTimeout({
                        toTitle: _94, 
                        toMessage: _95
                    }));
                });
            });
        };
        if (Data_Foreign_Index.hasOwnProperty(Data_Foreign_Index.indexString)("uiTitle")(_741)) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(isForeignUser)(Data_Foreign_Index.indexString)("uiData")(_741))(function (_97) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("uiTitle")(_741))(function (_96) {
                    return Prelude["return"](Data_Either.monadEither)(new Types.ResponseUserinfo({
                        uiTitle: _96, 
                        uiData: _97
                    }));
                });
            });
        };
        if (Prelude.otherwise) {
            return Prelude["return"](Data_Either.monadEither)(new Types.ResponseError({
                errTitle: "Other error", 
                errMessage: "Can't parse response 1"
            }));
        };
        throw new Error("Failed pattern match");
    };
    var isForeignResponseError = new Data_Foreign_Class.IsForeign(readX);
    var initialState = new Types.State({
        feed: new Types.AFeed({
            oldFeed: [  ], 
            currentFeed: [  ], 
            newFeed: [  ]
        }), 
        extraFeed: Data_Maybe.Nothing.value, 
        historyButtonDisabled: false, 
        userInfo: new Types.UserInfo({
            visible: false, 
            followRequestActive: false, 
            userdata: Data_Maybe.Nothing.value
        }), 
        writeInput: new Types.WriteInput({
            visible: false, 
            disabled: false, 
            value: "~", 
            replyTo: Data_Maybe.Nothing.value
        }), 
        contextMenu: new Types.ContextMenu({
            visible: false, 
            x: 0, 
            y: 0, 
            tweetId: Data_Maybe.Nothing.value
        }), 
        errors: [  ]
    });
    
    /**
     *  TODO get rid of singleton global state
     */
    var stateObservable = Utils.getNewObservable(initialState);
    var writeState = function (state) {
        return function (value) {
            return function __do() {
                Control_Monad_Eff_Ref.writeRef(state)(value)();
                var x = Utils.publishToObservable(stateObservable)(value);
                return Prelude.unit;
            };
        };
    };
    var setMessage = function (state) {
        return function (msg) {
            return function __do() {
                var _121 = readState(state)();
                return writeState(state)(Optic_Core[".~"](messagesL(Data_Identity.functorIdentity))(Prelude["++"](Data_Array.semigroupArray)(Optic_Core["^."](_121)(messagesL(Data_Const.functorConst)))([ msg ]))(_121))();
            };
        };
    };
    var hbdL = function (__dict_Functor_514) {
        return Optic_Core.lens(function (_728) {
            return _728.value0.historyButtonDisabled;
        })(function (_729) {
            return function (val) {
                return new Types.State((function () {
                    var _999 = {};
                    for (var _1000 in _729.value0) {
                        if (_729.value0.hasOwnProperty(_1000)) {
                            _999[_1000] = _729.value0[_1000];
                        };
                    };
                    _999.historyButtonDisabled = val;
                    return _999;
                })());
            };
        })(__dict_Functor_514);
    };
    var toggleHistoryButton = function (x) {
        return function (state) {
            return function __do() {
                var _123 = readState(state)();
                return writeState(state)(Optic_Core[".~"](hbdL(Data_Identity.functorIdentity))(x)(_123))();
            };
        };
    };
    var fromWsMessage = function (s) {
        var _1003 = Data_Foreign_Class.readJSON(Data_Foreign_Class.arrayIsForeign(isForeignTweet))(s);
        if (_1003 instanceof Data_Either.Left) {
            return [  ];
        };
        if (_1003 instanceof Data_Either.Right) {
            return _1003.value0;
        };
        throw new Error("Failed pattern match");
    };
    var fromResponse = function (x) {
        var _1006 = Data_Foreign_Class.readJSON(isForeignResponseError)(x);
        if (_1006 instanceof Data_Either.Left) {
            return new Types.ResponseError({
                errTitle: "Other error", 
                errMessage: "Can't parse response: " + Utils.toString(_1006.value0)
            });
        };
        if (_1006 instanceof Data_Either.Right) {
            return _1006.value0;
        };
        throw new Error("Failed pattern match");
    };
    var feedL = function (__dict_Functor_515) {
        return Optic_Core.lens(function (_730) {
            return _730.value0.feed;
        })(function (_731) {
            return function (f) {
                return new Types.State((function () {
                    var _1012 = {};
                    for (var _1013 in _731.value0) {
                        if (_731.value0.hasOwnProperty(_1013)) {
                            _1012[_1013] = _731.value0[_1013];
                        };
                    };
                    _1012.feed = f;
                    return _1012;
                })());
            };
        })(__dict_Functor_515);
    };
    var extraFeedL = function (__dict_Functor_516) {
        return Optic_Core.lens(function (_732) {
            return _732.value0.extraFeed;
        })(function (_733) {
            return function (ef) {
                return new Types.State((function () {
                    var _1018 = {};
                    for (var _1019 in _733.value0) {
                        if (_733.value0.hasOwnProperty(_1019)) {
                            _1018[_1019] = _733.value0[_1019];
                        };
                    };
                    _1018.extraFeed = ef;
                    return _1018;
                })());
            };
        })(__dict_Functor_516);
    };
    var errorM = function (m) {
        return new Types["Error"](m, Utils.runUUID(Utils.getUUID));
    };
    var enableHistoryButton = toggleHistoryButton(false);
    var disableHistoryButton = toggleHistoryButton(true);
    var currentFeedL = function (__dict_Functor_517) {
        return Optic_Core.lens(function (_738) {
            return _738.value0.currentFeed;
        })(function (_739) {
            return function (ts) {
                return new Types.AFeed((function () {
                    var _1024 = {};
                    for (var _1025 in _739.value0) {
                        if (_739.value0.hasOwnProperty(_1025)) {
                            _1024[_1025] = _739.value0[_1025];
                        };
                    };
                    _1024.currentFeed = ts;
                    return _1024;
                })());
            };
        })(__dict_Functor_517);
    };
    var contextMenuL = function (__dict_Functor_518) {
        return Optic_Core.lens(function (_722) {
            return _722.value0.contextMenu;
        })(function (_723) {
            return function (cm) {
                return new Types.State((function () {
                    var _1030 = {};
                    for (var _1031 in _723.value0) {
                        if (_723.value0.hasOwnProperty(_1031)) {
                            _1030[_1031] = _723.value0[_1031];
                        };
                    };
                    _1030.contextMenu = cm;
                    return _1030;
                })());
            };
        })(__dict_Functor_518);
    };
    var resetContextMenu = function (state) {
        return function __do() {
            var _122 = readState(state)();
            return writeState(state)(Optic_Core[".~"](contextMenuL(Data_Identity.functorIdentity))(new Types.ContextMenu({
                visible: false, 
                x: 0, 
                y: 0, 
                tweetId: Data_Maybe.Nothing.value
            }))(_122))();
        };
    };
    return {
        toggleHistoryButton: toggleHistoryButton, 
        disableHistoryButton: disableHistoryButton, 
        enableHistoryButton: enableHistoryButton, 
        setTitle: setTitle, 
        writeState: writeState, 
        readState: readState, 
        stateObservable: stateObservable, 
        resetContextMenu: resetContextMenu, 
        currentFeedL: currentFeedL, 
        oldFeedL: oldFeedL, 
        newFeedL: newFeedL, 
        extraFeedL: extraFeedL, 
        feedL: feedL, 
        hbdL: hbdL, 
        messagesL: messagesL, 
        writeInputL: writeInputL, 
        contextMenuL: contextMenuL, 
        writeInputValueL: writeInputValueL, 
        writeInputVisibleL: writeInputVisibleL, 
        writeInputDisabledL: writeInputDisabledL, 
        userInfoUserdataL: userInfoUserdataL, 
        userInfoVisibleL: userInfoVisibleL, 
        userInfoL: userInfoL, 
        initialState: initialState, 
        setMessage: setMessage, 
        errorM: errorM, 
        successM: successM, 
        fromWsMessage: fromWsMessage, 
        fromResponse: fromResponse, 
        readX: readX, 
        toTweetToken: toTweetToken, 
        isForeignUser: isForeignUser, 
        isForeignTweetElement: isForeignTweetElement, 
        isForeignAuthor: isForeignAuthor, 
        isForeignTweet: isForeignTweet, 
        isForeignResponseError: isForeignResponseError, 
        isForeignEntities: isForeignEntities, 
        isForeignEntityUrl: isForeignEntityUrl, 
        isForeignHashtag: isForeignHashtag, 
        isForeignMedia: isForeignMedia, 
        isForeignMediaSize: isForeignMediaSize, 
        isForeignMediaSizes: isForeignMediaSizes
    };
})();
var PS = PS || {};
PS.UI_Messages = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Core = PS.Core;
    var Optic_Core = PS.Optic_Core;
    var Data_Array = PS.Data_Array;
    var React_DOM = PS.React_DOM;
    var React = PS.React;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Types = PS.Types;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Utils = PS.Utils;
    var Data_Identity = PS.Data_Identity;
    var Data_Const = PS.Data_Const;
    var hideMessage = function (state) {
        return function (msgid) {
            var filterOutMsg = function (_744) {
                if (_744 instanceof Types["Error"]) {
                    return Prelude["/="](Utils.eqUUID)(_744.value1)(msgid);
                };
                if (_744 instanceof Types.Success) {
                    return Prelude["/="](Utils.eqUUID)(_744.value1)(msgid);
                };
                if (_744 instanceof Types.Other) {
                    return Prelude["/="](Utils.eqUUID)(_744.value1)(msgid);
                };
                throw new Error("Failed pattern match");
            };
            return function __do() {
                var _124 = Core.readState(state)();
                return Core.writeState(state)(Optic_Core[".~"](Core.messagesL(Data_Identity.functorIdentity))(Data_Array.filter(filterOutMsg)(Optic_Core["^."](_124)(Core.messagesL(Data_Const.functorConst))))(_124))();
            };
        };
    };
    var messageItemBody = function (state) {
        return function (msg) {
            return function (msgid) {
                return function (colorClass) {
                    return React_DOM.div({
                        className: "message " + colorClass
                    })([ React_DOM.span({})([ React_DOM.rawText(msg) ]), React_DOM.button({
                        className: "remove-message", 
                        onClick: hideMessage(state)(msgid)
                    })([ React_DOM.rawText("x") ]) ]);
                };
            };
        };
    };
    var messageItem = function (_742) {
        return function (_743) {
            if (_743 instanceof Types["Error"]) {
                return messageItemBody(_742)(_743.value0)(_743.value1)("red");
            };
            if (_743 instanceof Types.Success) {
                return messageItemBody(_742)(_743.value0)(_743.value1)("green");
            };
            if (_743 instanceof Types.Other) {
                return messageItemBody(_742)(_743.value0)(_743.value1)("blue");
            };
            throw new Error("Failed pattern match");
        };
    };
    
    /**
     *  TODO rename errorsList to messagesList
     */
    var errorsList = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _125 = Core.readState($$this.props.state)();
                return React_DOM.div({
                    className: "messages"
                })(Prelude["<$>"](Data_Array.functorArray)(messageItem($$this.props.state))(_125.value0.errors));
            };
        };
        return React.createClass((function () {
            var _1053 = {};
            for (var _1054 in React.spec) {
                if (React.spec.hasOwnProperty(_1054)) {
                    _1053[_1054] = React.spec[_1054];
                };
            };
            _1053.displayName = "Messages";
            _1053.render = renderFun;
            return _1053;
        })());
    })();
    return {
        errorsList: errorsList, 
        messageItem: messageItem, 
        messageItemBody: messageItemBody, 
        hideMessage: hideMessage
    };
})();
var PS = PS || {};
PS.UI_UserInfo = (function () {
    "use strict";
    var Core = PS.Core;
    var Prelude = PS.Prelude;
    var Optic_Core = PS.Optic_Core;
    var Utils = PS.Utils;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Rx_JQuery = PS.Rx_JQuery;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Unsafe = PS.Control_Monad_Eff_Unsafe;
    var React_DOM = PS.React_DOM;
    var UI_Types = PS.UI_Types;
    var React = PS.React;
    var Data_Maybe = PS.Data_Maybe;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Types = PS.Types;
    var Data_Array = PS.Data_Array;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Rx_Observable = PS.Rx_Observable;
    var Data_Identity = PS.Data_Identity;
    var Data_Const = PS.Data_Const;
    var showUserInfo = function (state) {
        return function __do() {
            var _128 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.userInfoVisibleL(Data_Identity.functorIdentity))(true)(Optic_Core["^."](_128)(Core.userInfoL(Data_Const.functorConst))))(_128))();
        };
    };
    var runEff = function (action) {
        return Control_Monad_Eff.runPure(Control_Monad_Eff_Unsafe.unsafeInterleaveEff(action));
    };
    var hideUserInfo = function (state) {
        return function __do() {
            var _129 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.userInfoVisibleL(Data_Identity.functorIdentity))(false)(Optic_Core["^."](_129)(Core.userInfoL(Data_Const.functorConst))))(_129))();
        };
    };
    var listenUserInfoKeys = function (state) {
        return function __do() {
            var _130 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("body"))(Rx_JQuery.onAsObservable("keyup"))();
            return (function () {
                var keyCodesS = Prelude["<$>"](Rx_Observable.functorObservable)(Utils.keyEventToKeyCode)(_130);
                return Utils["~>"](Utils.filterRx(Prelude["=="](Utils.eqKeyCode)(Utils.Escape.value))(keyCodesS))(function (_745) {
                    return hideUserInfo(state);
                });
            })()();
        };
    };
    var handleFollowUnfollow = function (state) {
        return function (url) {
            var handler = function (s) {
                var _1059 = Core.fromResponse(s);
                if (_1059 instanceof Types.ResponseError) {
                    return function __do() {
                        Core.enableHistoryButton(state)();
                        return Core.setMessage(state)(Core.errorM(_1059.value0.errMessage))();
                    };
                };
                if (_1059 instanceof Types.ResponseUserinfo) {
                    return function __do() {
                        Core.enableHistoryButton(state)();
                        var _131 = Core.readState(state)();
                        return Core.writeState(state)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(new Types.UserInfo({
                            visible: true, 
                            followRequestActive: false, 
                            userdata: new Data_Maybe.Just(_1059.value0.uiData)
                        }))(_131))();
                    };
                };
                throw new Error("Failed pattern match");
            };
            return function __do() {
                Core.disableHistoryButton(state)();
                var _132 = Core.readState(state)();
                Core.writeState(state)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(new Types.UserInfo({
                    visible: true, 
                    followRequestActive: true, 
                    userdata: Optic_Core["^."](Optic_Core["^."](_132)(Core.userInfoL(Data_Const.functorConst)))(Core.userInfoUserdataL(Data_Const.functorConst))
                }))(_132))();
                Utils["~>"](Utils.rioGet(url))(handler)();
                return Prelude.unit;
            };
        };
    };
    var getUnfollowUrl = function (sn) {
        return "/unfollow?sn=" + sn;
    };
    var handleUnfollow = function (state) {
        return function (sn) {
            return function (ev) {
                return function __do() {
                    Utils.stopPropagation(ev)();
                    handleFollowUnfollow(state)(getUnfollowUrl(sn))();
                    return Prelude.unit;
                };
            };
        };
    };
    var unfollowButton = function (state) {
        return function (user) {
            return function __do() {
                var _134 = Core.readState(state)();
                var _1069 = !_134.value0.userInfo.value0.followRequestActive;
                if (_1069) {
                    return React_DOM.button({
                        style: {
                            "margin-left": "8px"
                        }, 
                        onClick: Utils.callEventHandler(handleUnfollow(state)(user.userScreenName))
                    })([ React_DOM.rawText("Unfollow") ]);
                };
                if (!_1069) {
                    return React_DOM.img({
                        src: "/snake-loader.gif", 
                        style: {
                            margin: "1px 10px 1px 10px"
                        }
                    })([  ]);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var getFollowUrl = function (sn) {
        return "/follow?sn=" + sn;
    };
    var handleFollow = function (state) {
        return function (sn) {
            return function (ev) {
                return function __do() {
                    Utils.stopPropagation(ev)();
                    handleFollowUnfollow(state)(getFollowUrl(sn))();
                    return Prelude.unit;
                };
            };
        };
    };
    var followButton = function (state) {
        return function (user) {
            return function __do() {
                var _133 = Core.readState(state)();
                var _1075 = !_133.value0.userInfo.value0.followRequestActive;
                if (_1075) {
                    return React_DOM.button({
                        style: {
                            "margin-left": "8px"
                        }, 
                        onClick: Utils.callEventHandler(handleFollow(state)(user.userScreenName))
                    })([ React_DOM.rawText("Follow") ]);
                };
                if (!_1075) {
                    return React_DOM.img({
                        src: "/snake-loader.gif", 
                        style: {
                            margin: "1px 10px 1px 10px"
                        }
                    })([  ]);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    
    /**
     *  TODO handle other cases
     */
    var clearUserInfo = function (state) {
        return function __do() {
            var _127 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.userInfoUserdataL(Data_Identity.functorIdentity))(Data_Maybe.Nothing.value)(Optic_Core["^."](_127)(Core.userInfoL(Data_Const.functorConst))))(_127))();
        };
    };
    var loadUserInfo = function (_746) {
        return function (_747) {
            var handler = function (resp) {
                var _1083 = Core.fromResponse(resp);
                if (_1083 instanceof Types.ResponseError) {
                    return function __do() {
                        Core.enableHistoryButton(_746)();
                        return Core.setMessage(_746)(Core.errorM(_1083.value0.errMessage))();
                    };
                };
                if (_1083 instanceof Types.ResponseUserinfo) {
                    return function __do() {
                        Core.enableHistoryButton(_746)();
                        var _126 = Core.readState(_746)();
                        return Core.writeState(_746)(Optic_Core[".~"](Core.userInfoL(Data_Identity.functorIdentity))(new Types.UserInfo({
                            visible: true, 
                            followRequestActive: false, 
                            userdata: new Data_Maybe.Just(_1083.value0.uiData)
                        }))(_126))();
                    };
                };
                throw new Error("Failed pattern match");
            };
            var url = "/userinfo?sn=" + _747.value0.screen_name;
            return function __do() {
                Core.disableHistoryButton(_746)();
                clearUserInfo(_746)();
                showUserInfo(_746)();
                Utils["~>"](Utils.rioGet(url))(handler)();
                return Prelude.unit;
            };
        };
    };
    var avatarUrl = function (src) {
        return Utils.stringReplace(src)("_normal.")("_400x400.");
    };
    var asHtmlUser = new UI_Types.AsHtml(function (_748) {
        return function (_749) {
            return React_DOM.ul({
                style: {
                    display: "block", 
                    width: "600px", 
                    "text-align": "left", 
                    margin: "auto", 
                    overflow: "auto", 
                    padding: "20px", 
                    "background-color": "rgba(0,0,0,0.3)", 
                    height: "100%"
                }
            })([ React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ React_DOM.span({
                style: {
                    "font-size": "200%"
                }
            })([ React_DOM.rawText(_749.value0.userName), (function () {
                if (_749.value0.userVerified) {
                    return React_DOM.span({
                        style: {
                            color: "blue"
                        }
                    })([ React_DOM.rawText(" \u2022") ]);
                };
                if (!_749.value0.userVerified) {
                    return React_DOM.rawText("");
                };
                throw new Error("Failed pattern match");
            })(), (function () {
                if (_749.value0.userProtected) {
                    return React_DOM.span({
                        style: {
                            color: "red"
                        }
                    })([ React_DOM.rawText(" \u2022") ]);
                };
                if (!_749.value0.userProtected) {
                    return React_DOM.rawText("");
                };
                throw new Error("Failed pattern match");
            })() ]) ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ React_DOM.a({
                href: "https://twitter.com/" + _749.value0.userScreenName, 
                style: {
                    color: "lightgrey"
                }, 
                target: "_blank"
            })([ React_DOM.rawText("@" + _749.value0.userScreenName) ]) ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userProfileImageURL instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("");
                };
                if (_749.value0.userProfileImageURL instanceof Data_Maybe.Just) {
                    return React_DOM.img({
                        src: avatarUrl(_749.value0.userProfileImageURL.value0), 
                        style: {
                            width: "100px"
                        }
                    })([  ]);
                };
                throw new Error("Failed pattern match");
            })() ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userDescription instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("");
                };
                if (_749.value0.userDescription instanceof Data_Maybe.Just) {
                    return React_DOM.rawText(_749.value0.userDescription.value0);
                };
                throw new Error("Failed pattern match");
            })() ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userURL instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("");
                };
                if (_749.value0.userURL instanceof Data_Maybe.Just) {
                    return React_DOM.a({
                        style: {
                            color: "white", 
                            "text-decoration": "underline"
                        }, 
                        href: _749.value0.userURL.value0, 
                        target: "_blank"
                    })([ React_DOM.rawText(_749.value0.userURL.value0) ]);
                };
                throw new Error("Failed pattern match");
            })() ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userLocation instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("");
                };
                if (_749.value0.userLocation instanceof Data_Maybe.Just) {
                    return React_DOM.rawText(_749.value0.userLocation.value0);
                };
                throw new Error("Failed pattern match");
            })() ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userTimeZone instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("");
                };
                if (_749.value0.userTimeZone instanceof Data_Maybe.Just) {
                    return React_DOM.rawText(_749.value0.userTimeZone.value0 + " timezone");
                };
                throw new Error("Failed pattern match");
            })() ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ React_DOM.rawText("Registered on " + _749.value0.userCreatedAt) ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ React_DOM.rawText(Prelude.show(Prelude.showNumber)(_749.value0.userFollowersCount) + (" followers, " + (Prelude.show(Prelude.showNumber)(_749.value0.userFriendsCount) + (" friends, " + (Prelude.show(Prelude.showNumber)(_749.value0.userStatusesCount) + " tweets"))))) ]), React_DOM.li({
                style: {
                    margin: "0px", 
                    padding: "5px"
                }
            })([ (function () {
                if (_749.value0.userFollowing instanceof Data_Maybe.Nothing) {
                    return React_DOM.rawText("Following status unknown");
                };
                if (_749.value0.userFollowing instanceof Data_Maybe.Just) {
                    if (_749.value0.userFollowing.value0) {
                        return React_DOM.span({})([ React_DOM.rawText("Already following"), runEff(unfollowButton(_748)(_749.value0)) ]);
                    };
                    if (!_749.value0.userFollowing.value0) {
                        return React_DOM.span({})([ React_DOM.rawText("Not following"), runEff(followButton(_748)(_749.value0)) ]);
                    };
                    throw new Error("Failed pattern match");
                };
                throw new Error("Failed pattern match");
            })() ]) ]);
        };
    });
    var userInfo = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _135 = Core.readState($$this.props.state)();
                return React_DOM.div({
                    className: "user-info", 
                    onContextMenu: Utils.callEventHandler(Utils.stopPropagation), 
                    onClick: Utils.callEventHandler(Utils.stopPropagation), 
                    style: {
                        display: (function () {
                            if (_135.value0.userInfo.value0.visible) {
                                return "block";
                            };
                            if (!_135.value0.userInfo.value0.visible) {
                                return "none";
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        height: "440px", 
                        width: "100%", 
                        position: "fixed", 
                        top: "50%", 
                        overflow: "hidden", 
                        "background-color": (function () {
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Nothing) {
                                return "rgba(0,0,0,0.95)";
                            };
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Just) {
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBackgroundColor instanceof Data_Maybe.Nothing) {
                                    return "rgba(0,0,0,0.95)";
                                };
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBackgroundColor instanceof Data_Maybe.Just) {
                                    return "#" + _135.value0.userInfo.value0.userdata.value0.value0.userProfileBackgroundColor.value0;
                                };
                                throw new Error("Failed pattern match");
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        "background-image": (function () {
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Nothing) {
                                return "none";
                            };
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Just) {
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBannerURL instanceof Data_Maybe.Nothing) {
                                    return "none";
                                };
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBannerURL instanceof Data_Maybe.Just) {
                                    return "url(" + (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBannerURL.value0 + ")");
                                };
                                throw new Error("Failed pattern match");
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        "background-size": (function () {
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Nothing) {
                                return "auto";
                            };
                            if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Just) {
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBannerURL instanceof Data_Maybe.Nothing) {
                                    return "auto";
                                };
                                if (_135.value0.userInfo.value0.userdata.value0.value0.userProfileBannerURL instanceof Data_Maybe.Just) {
                                    return "cover";
                                };
                                throw new Error("Failed pattern match");
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        color: "white", 
                        transform: "translateY(-240px)"
                    }
                })([ (function () {
                    if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Nothing) {
                        return React_DOM.img({
                            src: "/snake-loader-darkbg.gif", 
                            style: {
                                position: "relative", 
                                top: "200px"
                            }
                        })([  ]);
                    };
                    if (_135.value0.userInfo.value0.userdata instanceof Data_Maybe.Just) {
                        return UI_Types.asHtml(asHtmlUser)($$this.props.state)(_135.value0.userInfo.value0.userdata.value0);
                    };
                    throw new Error("Failed pattern match");
                })() ]);
            };
        };
        return React.createClass((function () {
            var _1135 = {};
            for (var _1136 in React.spec) {
                if (React.spec.hasOwnProperty(_1136)) {
                    _1135[_1136] = React.spec[_1136];
                };
            };
            _1135.displayName = "Messages";
            _1135.render = renderFun;
            return _1135;
        })());
    })();
    return {
        userInfo: userInfo, 
        avatarUrl: avatarUrl, 
        unfollowButton: unfollowButton, 
        followButton: followButton, 
        runEff: runEff, 
        handleFollowUnfollow: handleFollowUnfollow, 
        handleUnfollow: handleUnfollow, 
        handleFollow: handleFollow, 
        getUnfollowUrl: getUnfollowUrl, 
        getFollowUrl: getFollowUrl, 
        listenUserInfoKeys: listenUserInfoKeys, 
        hideUserInfo: hideUserInfo, 
        showUserInfo: showUserInfo, 
        clearUserInfo: clearUserInfo, 
        loadUserInfo: loadUserInfo, 
        asHtmlUser: asHtmlUser
    };
})();
var PS = PS || {};
PS.UI_TweetWriter = (function () {
    "use strict";
    var Data_Foldable = PS.Data_Foldable;
    var Prelude = PS.Prelude;
    var Core = PS.Core;
    var Optic_Core = PS.Optic_Core;
    var Utils = PS.Utils;
    var Debug_Trace = PS.Debug_Trace;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Rx_JQuery = PS.Rx_JQuery;
    var React_DOM = PS.React_DOM;
    var React = PS.React;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Rx_Observable = PS.Rx_Observable;
    var Config = PS.Config;
    var Types = PS.Types;
    var Data_Identity = PS.Data_Identity;
    var Data_Const = PS.Data_Const;
    var Data_Array = PS.Data_Array;
    var Data_Monoid = PS.Data_Monoid;
    var showWriteInput = function (state) {
        return function __do() {
            var _137 = Core.readState(state)();
            Core.writeState(state)(Optic_Core[".~"](Core.writeInputL(Data_Identity.functorIdentity))(new Types.WriteInput({
                visible: true, 
                disabled: false, 
                value: "", 
                replyTo: Data_Maybe.Nothing.value
            }))(_137))();
            return Utils.forkPostpone(Utils.setFocus("write-input-id"))(50)();
        };
    };
    var hideWriteInput = function (state) {
        return function __do() {
            var _138 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.writeInputL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.writeInputVisibleL(Data_Identity.functorIdentity))(false)(Optic_Core["^."](_138)(Core.writeInputL(Data_Const.functorConst))))(_138))();
        };
    };
    var listenWriteKeys = function (state) {
        return function __do() {
            var _142 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("body"))(Rx_JQuery.onAsObservable("keyup"))();
            return (function () {
                var keyCodesS = Prelude["<$>"](Rx_Observable.functorObservable)(Utils.keyEventToKeyCode)(_142);
                return function __do() {
                    Utils["~>"](Utils.filterRx(Prelude["=="](Utils.eqKeyCode)(Utils.F2.value))(keyCodesS))(function (_750) {
                        return showWriteInput(state);
                    })();
                    return Utils["~>"](Utils.filterRx(Prelude["=="](Utils.eqKeyCode)(Utils.Escape.value))(keyCodesS))(function (_751) {
                        return hideWriteInput(state);
                    })();
                };
            })()();
        };
    };
    var handleChange = function ($$this) {
        return function (k) {
            return function __do() {
                var _141 = Core.readState($$this.props.state)();
                return Core.writeState($$this.props.state)(Optic_Core[".~"](Core.writeInputL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.writeInputValueL(Data_Identity.functorIdentity))(Utils.value(k.target))(Optic_Core["^."](_141)(Core.writeInputL(Data_Const.functorConst))))(_141))();
            };
        };
    };
    var getReplyToAuthors = function (_753) {
        var names = (function () {
            if (_753.value0.retweet instanceof Data_Maybe.Nothing) {
                return [ _753.value0.user.value0.screen_name ];
            };
            if (_753.value0.retweet instanceof Data_Maybe.Just) {
                return [ _753.value0.user.value0.screen_name, _753.value0.retweet.value0.value0.user.value0.screen_name ];
            };
            throw new Error("Failed pattern match");
        })();
        return Data_Foldable.foldl(Data_Foldable.foldableArray)(Prelude["++"](Prelude.semigroupString))("")(Prelude["<$>"](Data_Array.functorArray)(function (n) {
            return "@" + (n + " ");
        })(names));
    };
    var showReplyInput = function (state) {
        return function (mbTweet) {
            return function __do() {
                var _136 = Core.readState(state)();
                Core.writeState(state)(Optic_Core[".~"](Core.writeInputL(Data_Identity.functorIdentity))(new Types.WriteInput({
                    visible: true, 
                    disabled: false, 
                    value: (function () {
                        if (mbTweet instanceof Data_Maybe.Nothing) {
                            return "";
                        };
                        if (mbTweet instanceof Data_Maybe.Just) {
                            return getReplyToAuthors(mbTweet.value0);
                        };
                        throw new Error("Failed pattern match");
                    })(), 
                    replyTo: mbTweet
                }))(_136))();
                return Utils.forkPostpone(Utils.setFocus("write-input-id"))(50)();
            };
        };
    };
    var getAuthorsNames = function (_752) {
        var names = (function () {
            if (_752.value0.retweet instanceof Data_Maybe.Nothing) {
                return [ _752.value0.user.value0.name ];
            };
            if (_752.value0.retweet instanceof Data_Maybe.Just) {
                return [ _752.value0.user.value0.name, _752.value0.retweet.value0.value0.user.value0.name ];
            };
            throw new Error("Failed pattern match");
        })();
        return Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(", ")(names);
    };
    var disableWriteInput = function (state) {
        return function __do() {
            var _139 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.writeInputL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.writeInputDisabledL(Data_Identity.functorIdentity))(true)(Optic_Core["^."](_139)(Core.writeInputL(Data_Const.functorConst))))(_139))();
        };
    };
    var handleSubmitTweet = function (state) {
        return function (reply) {
            var tweetResultHandler = function (state_1) {
                return function (resp) {
                    return function __do() {
                        hideWriteInput(state_1)();
                        Core.enableHistoryButton(state_1)();
                        Debug_Trace.trace("tweeted " + Prelude.show(Prelude.showString)(resp))();
                        (function () {
                            var _1171 = Core.fromResponse(resp);
                            if (_1171 instanceof Types.ResponseError) {
                                return Core.setMessage(state_1)(Core.errorM(_1171.value0.errMessage));
                            };
                            if (_1171 instanceof Types.ResponseSuccess) {
                                if (reply instanceof Data_Maybe.Nothing) {
                                    return Core.setMessage(state_1)(Core.successM("Tweeted :-)"));
                                };
                                if (reply instanceof Data_Maybe.Just) {
                                    return Core.setMessage(state_1)(Core.successM("Replied :-)"));
                                };
                                throw new Error("Failed pattern match");
                            };
                            throw new Error("Failed pattern match");
                        })()();
                        return Prelude.unit;
                    };
                };
            };
            return function __do() {
                var _140 = Core.readState(state)();
                return (function () {
                    var _1181 = Optic_Core["^."](Optic_Core["^."](_140)(Core.writeInputL(Data_Const.functorConst)))(Core.writeInputValueL(Data_Const.functorConst));
                    if (_1181 === "") {
                        return function __do() {
                            Debug_Trace.trace("won't submit an empty tweet")();
                            Core.setMessage(state)(Core.errorM("Won't submit an empty tweet"))();
                            return Prelude.unit;
                        };
                    };
                    return function __do() {
                        disableWriteInput(state)();
                        Core.disableHistoryButton(state)();
                        Debug_Trace.trace("gonna tweet this: " + _1181)();
                        var url = (function () {
                            if (reply instanceof Data_Maybe.Nothing) {
                                return "/tweet?status=" + _1181;
                            };
                            if (reply instanceof Data_Maybe.Just) {
                                return "/reply?status=" + (_1181 + ("&reply_to=" + reply.value0.value0.id_str));
                            };
                            throw new Error("Failed pattern match");
                        })();
                        Utils["~>"](Utils.rioPost(url)(Data_Maybe.Nothing.value))(tweetResultHandler(state))();
                        return Prelude.unit;
                    };
                })()();
            };
        };
    };
    var handleWriteKeyPress = function (reply) {
        return function ($$this) {
            return function (k) {
                var _1186 = Utils.keyEventToKeyCode(k);
                if (_1186 instanceof Utils.Escape) {
                    return hideWriteInput($$this.props.state);
                };
                if (_1186 instanceof Utils.Enter) {
                    return handleSubmitTweet($$this.props.state)(reply);
                };
                return Prelude.pure(Control_Monad_Eff.applicativeEff)(Prelude.unit);
            };
        };
    };
    var writeInputComponent = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _143 = Core.readState($$this.props.state)();
                return React_DOM.div({
                    className: "write-tweet", 
                    disabled: _143.value0.writeInput.value0.disabled, 
                    onContextMenu: Utils.callEventHandler(Utils.stopPropagation), 
                    onClick: Utils.callEventHandler(Utils.stopPropagation), 
                    style: {
                        display: (function () {
                            if (_143.value0.writeInput.value0.visible) {
                                return "block";
                            };
                            if (!_143.value0.writeInput.value0.visible) {
                                return "none";
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        height: (function () {
                            if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Nothing) {
                                return "50px";
                            };
                            if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Just) {
                                return "100px";
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        transform: (function () {
                            if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Nothing) {
                                return "translateY(-70px)";
                            };
                            if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Just) {
                                return "translateY(-140px)";
                            };
                            throw new Error("Failed pattern match");
                        })()
                    }
                })([ (function () {
                    if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Nothing) {
                        return React_DOM.div({})([  ]);
                    };
                    if (_143.value0.writeInput.value0.replyTo instanceof Data_Maybe.Just) {
                        return React_DOM.div({
                            style: {
                                color: "white", 
                                width: "710px", 
                                padding: "20px", 
                                "padding-top": "0px", 
                                "text-align": "left", 
                                margin: "auto"
                            }
                        })([ React_DOM.rawText("Reply to " + getAuthorsNames(_143.value0.writeInput.value0.replyTo.value0)) ]);
                    };
                    throw new Error("Failed pattern match");
                })(), React_DOM.input({
                    type: "text", 
                    id: "write-input-id", 
                    value: _143.value0.writeInput.value0.value, 
                    onChange: React.eventHandler($$this)(handleChange), 
                    onKeyUp: React.eventHandler($$this)(handleWriteKeyPress(_143.value0.writeInput.value0.replyTo))
                })([  ]), React_DOM.button({
                    className: "writer-button ok", 
                    onClick: handleSubmitTweet($$this.props.state)(_143.value0.writeInput.value0.replyTo)
                })([ React_DOM.rawText("\u2713") ]), React_DOM.button({
                    className: "writer-button nok", 
                    onClick: hideWriteInput($$this.props.state)
                })([ React_DOM.rawText("\u2a2f") ]) ]);
            };
        };
        return React.createClass((function () {
            var _1202 = {};
            for (var _1203 in React.spec) {
                if (React.spec.hasOwnProperty(_1203)) {
                    _1202[_1203] = React.spec[_1203];
                };
            };
            _1202.displayName = "writeInputComponent";
            _1202.render = renderFun;
            return _1202;
        })());
    })();
    return {
        writeInputComponent: writeInputComponent, 
        listenWriteKeys: listenWriteKeys, 
        handleWriteKeyPress: handleWriteKeyPress, 
        handleChange: handleChange, 
        handleSubmitTweet: handleSubmitTweet, 
        disableWriteInput: disableWriteInput, 
        hideWriteInput: hideWriteInput, 
        showWriteInput: showWriteInput, 
        showReplyInput: showReplyInput, 
        getReplyToAuthors: getReplyToAuthors, 
        getAuthorsNames: getAuthorsNames
    };
})();
var PS = PS || {};
PS.UI_Feed = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Core = PS.Core;
    var Optic_Core = PS.Optic_Core;
    var Utils = PS.Utils;
    var Data_Array = PS.Data_Array;
    var Debug_Trace = PS.Debug_Trace;
    var Config = PS.Config;
    var React_DOM = PS.React_DOM;
    var React = PS.React;
    var Data_Foldable = PS.Data_Foldable;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Rx_JQuery = PS.Rx_JQuery;
    var Lib_WebSocket = PS.Lib_WebSocket;
    var UI_UserInfo = PS.UI_UserInfo;
    var UI_TweetWriter = PS.UI_TweetWriter;
    var Data_String = PS.Data_String;
    var UI_Types = PS.UI_Types;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Rx_Observable = PS.Rx_Observable;
    var Types = PS.Types;
    var Data_Identity = PS.Data_Identity;
    var Data_Const = PS.Data_Const;
    var showNewTweets = function (state) {
        return function __do() {
            var _144 = Core.readState(state)();
            Core.writeState(state)(Optic_Core[".~"](Core.feedL(Data_Identity.functorIdentity))(new Types.AFeed({
                oldFeed: Types.OldFeed(Prelude["++"](Data_Array.semigroupArray)(_144.value0.feed.value0.oldFeed)(_144.value0.feed.value0.currentFeed)), 
                currentFeed: _144.value0.feed.value0.newFeed, 
                newFeed: [  ]
            }))(_144))();
            Utils.scrollToTop();
            return Prelude.unit;
        };
    };
    var showContextMenu = function (state) {
        return function (x) {
            return function (y) {
                return function (tid) {
                    return function __do() {
                        var _157 = Core.readState(state)();
                        return Core.writeState(state)(Optic_Core[".~"](Core.contextMenuL(Data_Identity.functorIdentity))(new Types.ContextMenu({
                            visible: true, 
                            x: x, 
                            y: y, 
                            tweetId: new Data_Maybe.Just(tid)
                        }))(_157))();
                    };
                };
            };
        };
    };
    var tweetContextMenu = function (state) {
        return function (id_str) {
            return function (e) {
                return function __do() {
                    Utils.stopPropagation(e)();
                    return showContextMenu(state)(e.nativeEvent.pageX)(e.nativeEvent.pageY)(id_str)();
                };
            };
        };
    };
    
    /**
     * ------------------------------------------------------------------------------
     */
    var processTweetElement = function (_765) {
        return function (_766) {
            if (_766 instanceof Types.Link) {
                var f = function (_773) {
                    return function (_774) {
                        return _774.value0.eUrl === _773;
                    };
                };
                var filterUrl = function (url) {
                    return Data_Array.filter(f(_766.value0))(_765.value0.urls);
                };
                var matchUrl = function (url) {
                    var _1218 = filterUrl(url);
                    if (_1218.length === 1) {
                        return new Data_Maybe.Just(_1218[0]);
                    };
                    return Data_Maybe.Nothing.value;
                };
                var _1220 = matchUrl(_766.value0);
                if (_1220 instanceof Data_Maybe.Nothing) {
                    return new Types.Link(_766.value0);
                };
                if (_1220 instanceof Data_Maybe.Just) {
                    return new Types.Link(_1220.value0.value0.eExpandedUrl);
                };
                throw new Error("Failed pattern match");
            };
            return _766;
        };
    };
    var onNewTweets = function (_757) {
        return function (_758) {
            if (_758.length === 0) {
                return function __do() {
                    Debug_Trace.trace("got no tweets")();
                    return Prelude.unit;
                };
            };
            return function __do() {
                var _148 = Core.readState(_757)();
                return (function () {
                    var feed = Optic_Core["^."](_148)(Core.feedL(Data_Const.functorConst));
                    var newState = Optic_Core[".~"](Core.feedL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.newFeedL(Data_Identity.functorIdentity))(Prelude["++"](Types.semigroupNewFeed)(Optic_Core["^."](feed)(Core.newFeedL(Data_Const.functorConst)))(_758))(feed))(_148);
                    return Core.writeState(_757)(newState);
                })()();
            };
        };
    };
    var onHistoryTweets = function (_755) {
        return function (_756) {
            if (_756.length === 0) {
                return function __do() {
                    Debug_Trace.trace("got no history tweets")();
                    return Prelude.unit;
                };
            };
            return function __do() {
                var _147 = Core.readState(_755)();
                return (function () {
                    var feed = Optic_Core["^."](_147)(Core.feedL(Data_Const.functorConst));
                    var newState = Optic_Core[".~"](Core.feedL(Data_Identity.functorIdentity))(Optic_Core[".~"](Core.oldFeedL(Data_Identity.functorIdentity))(Prelude["++"](Types.semigroupOldFeed)(Data_Array.reverse(_756))(Optic_Core["^."](feed)(Core.oldFeedL(Data_Const.functorConst))))(feed))(_147);
                    return Core.writeState(_755)(newState);
                })()();
            };
        };
    };
    var onError = function (state) {
        return function (title) {
            return function (message) {
                return Core.setMessage(state)(Core.errorM(message));
            };
        };
    };
    var startWsClient = function (state) {
        var onMessage = function (m) {
            return onNewTweets(state)(Core.fromWsMessage(m));
        };
        var onError_1 = function __do() {
            Debug_Trace.trace("ws error")();
            return Prelude.unit;
        };
        var onClose = function __do() {
            Debug_Trace.trace("ws closed")();
            startWsClient(state)();
            return Prelude.unit;
        };
        return function __do() {
            var _152 = Lib_WebSocket.mkWebSocket(Config.socketUrl)();
            Debug_Trace.trace("ws connected")();
            Lib_WebSocket.onMessage(_152)(onMessage)();
            Lib_WebSocket.onError(_152)(onError_1)();
            Lib_WebSocket.onClose(_152)(onClose)();
            return Prelude.unit;
        };
    };
    var loadUserFeed = function (_769) {
        return function (_770) {
            var getAuthor = function (_775) {
                return _775.value0.user;
            };
            var handler = function (resp) {
                var _1239 = Core.fromResponse(resp);
                if (_1239 instanceof Types.ResponseError) {
                    return function __do() {
                        Core.enableHistoryButton(_769)();
                        onError(_769)(_1239.value0.errTitle)(_1239.value0.errMessage)();
                        return Prelude.unit;
                    };
                };
                if (_1239 instanceof Types.ResponseSuccess) {
                    return function __do() {
                        Core.enableHistoryButton(_769)();
                        var _155 = Core.readState(_769)();
                        return (function () {
                            if (_1239.value0.okTweets.length >= 1) {
                                var _1246 = _1239.value0.okTweets.slice(1);
                                return Core.writeState(_769)(Optic_Core[".~"](Core.extraFeedL(Data_Identity.functorIdentity))(Data_Maybe.Just.create(new Types.BFeed({
                                    oldFeed: Data_Array.reverse(_1246), 
                                    currentFeed: [ _1239.value0.okTweets[0] ], 
                                    newFeed: [  ], 
                                    author: getAuthor(_1239.value0.okTweets[0])
                                })))(_155));
                            };
                            if (_1239.value0.okTweets.length === 1) {
                                return Core.writeState(_769)(Optic_Core[".~"](Core.extraFeedL(Data_Identity.functorIdentity))(Data_Maybe.Just.create(new Types.BFeed({
                                    oldFeed: [  ], 
                                    currentFeed: [ _1239.value0.okTweets[0] ], 
                                    newFeed: [  ], 
                                    author: getAuthor(_1239.value0.okTweets[0])
                                })))(_155));
                            };
                            return Core.writeState(_769)(Optic_Core[".~"](Core.extraFeedL(Data_Identity.functorIdentity))(Data_Maybe.Just.create(new Types.BFeed({
                                oldFeed: [  ], 
                                currentFeed: [  ], 
                                newFeed: [  ], 
                                author: _770
                            })))(_155));
                        })()();
                    };
                };
                throw new Error("Failed pattern match");
            };
            return function __do() {
                Debug_Trace.trace("gonna load user feed")();
                var url = "/userfeed/?sn=" + _770.value0.screen_name;
                Core.disableHistoryButton(_769)();
                return Utils["~>"](Utils.rioGet(url))(handler)();
            };
        };
    };
    var loadUserFeedByName = function (state) {
        return function (sn) {
            return loadUserFeed(state)(new Types.Author({
                name: sn, 
                authorId: 0, 
                screen_name: sn, 
                default_profile_image: true, 
                profile_image_url: "?"
            }));
        };
    };
    var listenFeedKeys = function (state) {
        var f = function (_771) {
            return function __do() {
                showNewTweets(state)();
                return Prelude.unit;
            };
        };
        return function __do() {
            var _151 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("body"))(Rx_JQuery.onAsObservable("keyup"))();
            return (function () {
                var keyCodesS = Prelude["<$>"](Rx_Observable.functorObservable)(Utils.keyEventToKeyCode)(_151);
                return Utils["~>"](Utils.filterRx(Prelude["=="](Utils.eqKeyCode)(Utils.F4.value))(keyCodesS))(f);
            })()();
        };
    };
    var handleStarClick = function (state) {
        return function (id_) {
            var starResultHandler = function (resp) {
                return function __do() {
                    Core.enableHistoryButton(state)();
                    Debug_Trace.trace("starred " + Prelude.show(Prelude.showString)(resp))();
                    Core.setMessage(state)(Core.successM("Starred :-)"))();
                    return Prelude.unit;
                };
            };
            return function __do() {
                Core.resetContextMenu(state)();
                var url = "/star?id=" + id_;
                Core.disableHistoryButton(state)();
                Utils["~>"](Utils.rioPost(url)(Data_Maybe.Nothing.value))(starResultHandler)();
                return Prelude.unit;
            };
        };
    };
    var handleRetweetClick = function (state) {
        return function (id_) {
            var retweetResultHandler = function (resp) {
                return function __do() {
                    Core.enableHistoryButton(state)();
                    Debug_Trace.trace("retweeted " + Prelude.show(Prelude.showString)(resp))();
                    Core.setMessage(state)(Core.successM("Retweeted :-)"))();
                    return Prelude.unit;
                };
            };
            return function __do() {
                Core.resetContextMenu(state)();
                var url = "/retweet/?id=" + id_;
                Core.disableHistoryButton(state)();
                Utils["~>"](Utils.rioPost(url)(Data_Maybe.Nothing.value))(retweetResultHandler)();
                return Prelude.unit;
            };
        };
    };
    var handleAuthorContextMenu = function (_762) {
        return function (_763) {
            return function (_764) {
                return function __do() {
                    Utils.stopPropagation(_764)();
                    Core.resetContextMenu(_762)();
                    return UI_UserInfo.loadUserInfo(_762)(_763)();
                };
            };
        };
    };
    var getTweetById = function (state) {
        return function (tid) {
            return function __do() {
                var _153 = Core.readState(state)();
                return (function () {
                    
                    /**
                     *  TODO make extra feed work too
                     */
                    var unp = function (_772) {
                        return _772;
                    };
                    var cf = Optic_Core["^."](Optic_Core["^."](_153)(Core.feedL(Data_Const.functorConst)))(Core.currentFeedL(Data_Const.functorConst));
                    var res = Data_Array.filter(function (_754) {
                        return _754.value0.id_str === tid;
                    })(unp(cf));
                    return Prelude["return"](Control_Monad_Eff.monadEff)((function () {
                        if (res.length === 0) {
                            return Data_Maybe.Nothing.value;
                        };
                        if (res.length === 1) {
                            return new Data_Maybe.Just(res[0]);
                        };
                        if (res.length >= 1) {
                            var _1268 = res.slice(1);
                            return new Data_Maybe.Just(res[0]);
                        };
                        throw new Error("Failed pattern match");
                    })());
                })()();
            };
        };
    };
    var handleReplyClick = function (state) {
        return function (id_) {
            return function __do() {
                Core.resetContextMenu(state)();
                var _154 = getTweetById(state)(id_)();
                return (function () {
                    if (_154 instanceof Data_Maybe.Nothing) {
                        return Core.setMessage(state)(Core.errorM("Cant't find tweet with id=" + id_));
                    };
                    if (_154 instanceof Data_Maybe.Just) {
                        return UI_TweetWriter.showReplyInput(state)(_154);
                    };
                    throw new Error("Failed pattern match");
                })()();
            };
        };
    };
    var getOrigTweetUrl = function (_767) {
        return function (_768) {
            return "https://twitter.com/" + (_767.value0.screen_name + ("/status/" + _768));
        };
    };
    
    /**
     * ------------------------------------------------------------------------------
     */
    var tweetMenu = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _156 = Core.readState($$this.props.state)();
                if (_156.value0.contextMenu.value0.tweetId instanceof Data_Maybe.Just) {
                    return React_DOM.span({
                        className: "toolbar-target", 
                        onContextMenu: Utils.callEventHandler(Utils.stopPropagation), 
                        onClick: Utils.callEventHandler(Utils.stopPropagation), 
                        style: {
                            display: (function () {
                                if (_156.value0.contextMenu.value0.visible) {
                                    return "block";
                                };
                                if (!_156.value0.contextMenu.value0.visible) {
                                    return "none";
                                };
                                throw new Error("Failed pattern match");
                            })(), 
                            position: "absolute", 
                            left: _156.value0.contextMenu.value0.x, 
                            top: _156.value0.contextMenu.value0.y
                        }
                    })([ React_DOM.ul({
                        className: "toolbar", 
                        id: "menu-" + _156.value0.contextMenu.value0.tweetId.value0
                    })([ React_DOM.li({
                        "data-tweet-id": _156.value0.contextMenu.value0.tweetId.value0, 
                        title: "Retweet", 
                        onClick: handleRetweetClick($$this.props.state)(_156.value0.contextMenu.value0.tweetId.value0)
                    })([ React_DOM.rawText("RT") ]), React_DOM.li({
                        title: "Reply", 
                        onClick: handleReplyClick($$this.props.state)(_156.value0.contextMenu.value0.tweetId.value0)
                    })([ React_DOM.rawText("\u21a9") ]), React_DOM.li({
                        title: "Star", 
                        onClick: handleStarClick($$this.props.state)(_156.value0.contextMenu.value0.tweetId.value0)
                    })([ React_DOM.rawText("\u2605") ]), React_DOM.li({})([ React_DOM.a({
                        href: getOrigTweetUrl(new Types.Author({
                            name: "fake", 
                            authorId: 0, 
                            screen_name: "this.props.author", 
                            default_profile_image: true, 
                            profile_image_url: "-"
                        }))(_156.value0.contextMenu.value0.tweetId.value0), 
                        target: "_blank", 
                        title: "View original"
                    })([ React_DOM.rawText("\u2318") ]) ]) ]) ]);
                };
                if (_156.value0.contextMenu.value0.tweetId instanceof Data_Maybe.Nothing) {
                    return React_DOM.span({
                        className: "toolbar-target"
                    })([ React_DOM.rawText("No tweet selected") ]);
                };
                throw new Error("Failed pattern match");
            };
        };
        return React.createClass((function () {
            var _1287 = {};
            for (var _1288 in React.spec) {
                if (React.spec.hasOwnProperty(_1288)) {
                    _1287[_1288] = React.spec[_1288];
                };
            };
            _1287.displayName = "TweetMenu";
            _1287.render = renderFun;
            return _1287;
        })());
    })();
    var getHistoryUrl = function (maxid) {
        return function (count) {
            return Config.historyUrl + ("?maxid=" + (maxid + ("&count=" + Prelude.show(Prelude.showNumber)(count))));
        };
    };
    var showOldTweets = function (state) {
        return function (count) {
            return function __do() {
                var _146 = Core.readState(state)();
                return (function () {
                    if (_146.value0.extraFeed instanceof Data_Maybe.Just) {
                        var l = Data_Array.length(_146.value0.extraFeed.value0.value0.oldFeed);
                        var splitIdx = (function () {
                            var _1291 = l > count;
                            if (_1291) {
                                return l - count;
                            };
                            if (!_1291) {
                                return 0;
                            };
                            throw new Error("Failed pattern match");
                        })();
                        var chunks = Utils.splitAt(_146.value0.extraFeed.value0.value0.oldFeed)(splitIdx);
                        if (chunks.length === 2) {
                            return Core.writeState(state)(Optic_Core[".~"](Core.extraFeedL(Data_Identity.functorIdentity))(Data_Maybe.Just.create(new Types.BFeed({
                                oldFeed: chunks[0], 
                                currentFeed: Types.CurrentFeed(Prelude["++"](Data_Array.semigroupArray)(chunks[1])(_146.value0.extraFeed.value0.value0.currentFeed)), 
                                newFeed: _146.value0.extraFeed.value0.value0.newFeed, 
                                author: _146.value0.extraFeed.value0.value0.author
                            })))(_146));
                        };
                        throw new Error("Failed pattern match");
                    };
                    if (_146.value0.extraFeed instanceof Data_Maybe.Nothing) {
                        return function __do() {
                            var _145 = Core.readState(state)();
                            return (function () {
                                var l = Data_Array.length(_145.value0.feed.value0.oldFeed);
                                var splitIdx = (function () {
                                    var _1302 = l > count;
                                    if (_1302) {
                                        return l - count;
                                    };
                                    if (!_1302) {
                                        return 0;
                                    };
                                    throw new Error("Failed pattern match");
                                })();
                                var chunks = Utils.splitAt(_145.value0.feed.value0.oldFeed)(splitIdx);
                                if (chunks.length === 2) {
                                    return function __do() {
                                        Core.writeState(state)(Optic_Core[".~"](Core.feedL(Data_Identity.functorIdentity))(new Types.AFeed({
                                            oldFeed: chunks[0], 
                                            currentFeed: Types.CurrentFeed(Prelude["++"](Data_Array.semigroupArray)(chunks[1])(_145.value0.feed.value0.currentFeed)), 
                                            newFeed: _145.value0.feed.value0.newFeed
                                        }))(_145))();
                                        var maxid = (function () {
                                            var _1304 = Data_Array.head(chunks[0]);
                                            if (_1304 instanceof Data_Maybe.Just) {
                                                return _1304.value0.value0.id_str;
                                            };
                                            if (_1304 instanceof Data_Maybe.Nothing) {
                                                var _1308 = Data_Array.head(chunks[1]);
                                                if (_1308 instanceof Data_Maybe.Just) {
                                                    return _1308.value0.value0.id_str;
                                                };
                                                if (_1308 instanceof Data_Maybe.Nothing) {
                                                    var _1312 = Data_Array.head(_145.value0.feed.value0.newFeed);
                                                    if (_1312 instanceof Data_Maybe.Just) {
                                                        return _1312.value0.value0.id_str;
                                                    };
                                                    if (_1312 instanceof Data_Maybe.Nothing) {
                                                        return "0";
                                                    };
                                                    throw new Error("Failed pattern match");
                                                };
                                                throw new Error("Failed pattern match");
                                            };
                                            throw new Error("Failed pattern match");
                                        })();
                                        Debug_Trace.trace("maybe loading history w/ maxid=" + maxid)();
                                        maybeLoadMoreHistory(state)(Data_Array.length(chunks[0]))(maxid)();
                                        return Prelude.unit;
                                    };
                                };
                                return Prelude.pure(Control_Monad_Eff.applicativeEff)(Prelude.unit);
                            })()();
                        };
                    };
                    throw new Error("Failed pattern match");
                })()();
            };
        };
    };
    var maybeLoadMoreHistory = function (_759) {
        return function (_760) {
            return function (_761) {
                if (_760 === 0) {
                    var handleUpdate = function (s) {
                        var _1329 = Core.fromResponse(s);
                        if (_1329 instanceof Types.ResponseError) {
                            return function __do() {
                                Core.enableHistoryButton(_759)();
                                onError(_759)(_1329.value0.errTitle)(_1329.value0.errMessage)();
                                return Prelude.unit;
                            };
                        };
                        if (_1329 instanceof Types.ResponseSuccess) {
                            return function __do() {
                                Core.enableHistoryButton(_759)();
                                onHistoryTweets(_759)(_1329.value0.okTweets)();
                                showOldTweets(_759)(1)();
                                return Prelude.unit;
                            };
                        };
                        throw new Error("Failed pattern match");
                    };
                    return function __do() {
                        Core.disableHistoryButton(_759)();
                        return Utils["~>"](Utils.rioGet(getHistoryUrl(_761)(20)))(handleUpdate)();
                    };
                };
                return Prelude.pure(Control_Monad_Eff.applicativeEff)(Prelude.unit);
            };
        };
    };
    
    /**
     * ------------------------------------------------------------------------------
     */
    var historyButton = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _149 = Core.readState($$this.props.state)();
                return React_DOM.button({
                    className: (function () {
                        if (_149.value0.historyButtonDisabled) {
                            return "history-button disabled";
                        };
                        if (!_149.value0.historyButtonDisabled) {
                            return "history-button";
                        };
                        throw new Error("Failed pattern match");
                    })(), 
                    onClick: showOldTweets($$this.props.state)(1), 
                    disabled: (function () {
                        if (_149.value0.historyButtonDisabled) {
                            return "disabled";
                        };
                        if (!_149.value0.historyButtonDisabled) {
                            return "";
                        };
                        throw new Error("Failed pattern match");
                    })(), 
                    id: "load-history-tweets-id"
                })([ (function () {
                    if (_149.value0.historyButtonDisabled) {
                        return React_DOM.img({
                            src: "/snake-loader.gif"
                        })([  ]);
                    };
                    if (!_149.value0.historyButtonDisabled) {
                        return React_DOM.rawText("");
                    };
                    throw new Error("Failed pattern match");
                })() ]);
            };
        };
        return React.createClass((function () {
            var _1342 = {};
            for (var _1343 in React.spec) {
                if (React.spec.hasOwnProperty(_1343)) {
                    _1342[_1343] = React.spec[_1343];
                };
            };
            _1342.displayName = "historyButton";
            _1342.render = renderFun;
            return _1342;
        })());
    })();
    var feedClickHandler = function (ev) {
        return function __do() {
            Debug_Trace.trace("got mouse click")();
            Debug_Trace.trace(Utils.toString(ev))();
            return Prelude.unit;
        };
    };
    
    /**
     * ------------------------------------------------------------------------------
     */
    var checkButton = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _150 = Core.readState($$this.props.state)();
                return (function () {
                    var count = Data_Array.length(_150.value0.feed.value0.newFeed);
                    return Prelude.pure(Control_Monad_Eff.applicativeEff)(React_DOM.button({
                        className: (function () {
                            var _1345 = count === 0;
                            if (_1345) {
                                return "no-new-tweets pop";
                            };
                            if (!_1345) {
                                return "there-are-new-tweets pop";
                            };
                            throw new Error("Failed pattern match");
                        })(), 
                        onClick: showNewTweets($$this.props.state), 
                        id: "load-new-tweets-id"
                    })([ React_DOM.rawText(Prelude.show(Prelude.showNumber)(count)) ]));
                })()();
            };
        };
        return React.createClass((function () {
            var _1350 = {};
            for (var _1351 in React.spec) {
                if (React.spec.hasOwnProperty(_1351)) {
                    _1350[_1351] = React.spec[_1351];
                };
            };
            _1350.displayName = "CheckButton";
            _1350.render = renderFun;
            return _1350;
        })());
    })();
    
    /**
     * ------------------------------------------------------------------------------
     */
    var asHtmlTweetElement = new UI_Types.AsHtml(function (_776) {
        return function (_777) {
            if (_777 instanceof Types.AtUsername) {
                return React_DOM.span({
                    className: "username-tag"
                })([ React_DOM.span({
                    href: "https://twitter.com/" + _777.value0, 
                    onClick: loadUserFeedByName(_776)(_777.value0), 
                    style: {
                        cursor: "pointer", 
                        color: "black"
                    }, 
                    target: "_blank"
                })([ React_DOM.rawText("@" + _777.value0) ]) ]);
            };
            if (_777 instanceof Types.Link) {
                var linkToText = function (u) {
                    var _1355 = Data_Array["!!"](Data_String.split("/")(u))(2);
                    if (_1355 instanceof Data_Maybe.Nothing) {
                        return u;
                    };
                    if (_1355 instanceof Data_Maybe.Just) {
                        return _1355.value0;
                    };
                    throw new Error("Failed pattern match");
                };
                return React_DOM.a({
                    className: "inline-link", 
                    target: "_blank", 
                    href: _777.value0
                })([ React_DOM.rawText(linkToText(_777.value0)) ]);
            };
            if (_777 instanceof Types.PlainText) {
                return React_DOM.span({
                    className: "text-tag", 
                    dangerouslySetInnerHTML: {
                        __html: _777.value0
                    }
                })([  ]);
            };
            if (_777 instanceof Types.Hashtag) {
                return React_DOM.span({
                    className: "hash-tag"
                })([ React_DOM.a({
                    href: "https://twitter.com/hashtag/" + (_777.value0 + "?src=hash"), 
                    target: "_blank"
                })([ React_DOM.rawText("#" + _777.value0) ]) ]);
            };
            if (_777 instanceof Types.Retweet) {
                return React_DOM.span({
                    className: "retweet-tag"
                })([ React_DOM.rawText("RT") ]);
            };
            if (_777 instanceof Types.Spaces) {
                return React_DOM.span({})([ React_DOM.rawText(_777.value0) ]);
            };
            if (_777 instanceof Types.Unparsable) {
                return React_DOM.span({
                    className: "unparsable"
                })([ React_DOM.rawText(_777.value0) ]);
            };
            throw new Error("Failed pattern match");
        };
    });
    var asHtmlMedia = new UI_Types.AsHtml(function (_784) {
        return function (_785) {
            if (_785.value0.mType === "photo") {
                return React_DOM.img({
                    className: "inline-img", 
                    src: _785.value0.mMediaUrl
                })([  ]);
            };
            return React_DOM.div({
                className: "unknown-media"
            })([ React_DOM.rawText("Unknown media") ]);
        };
    });
    var asHtmlEntities = new UI_Types.AsHtml(function (_782) {
        return function (_783) {
            if (_783.value0.media instanceof Data_Maybe.Just) {
                return React_DOM.div({
                    className: "media"
                })(Prelude["<$>"](Data_Array.functorArray)(UI_Types.asHtml(asHtmlMedia)(_782))(_783.value0.media.value0));
            };
            if (_783.value0.media instanceof Data_Maybe.Nothing) {
                return React_DOM.div({
                    className: "media"
                })([  ]);
            };
            throw new Error("Failed pattern match");
        };
    });
    var asHtmlAuthor = new UI_Types.AsHtml(function (_780) {
        return function (_781) {
            return React_DOM.span({
                className: "user-icon"
            })([ React_DOM.span({
                href: "https://twitter.com/" + _781.value0.screen_name, 
                target: "_blank"
            })([ React_DOM.img({
                className: "user-icon-img", 
                style: {
                    cursor: "pointer"
                }, 
                onClick: loadUserFeed(_780)(_781), 
                onContextMenu: Utils.callEventHandler(handleAuthorContextMenu(_780)(_781)), 
                src: _781.value0.profile_image_url, 
                title: _781.value0.name
            })([  ]) ]) ]);
        };
    });
    var tweetComponent = (function () {
        var authorToHtml = function (_786) {
            return function (_787) {
                return function (_788) {
                    if (_788 instanceof Data_Maybe.Nothing) {
                        return UI_Types.asHtml(asHtmlAuthor)(_786)(_787);
                    };
                    if (_788 instanceof Data_Maybe.Just) {
                        return React_DOM.span({
                            className: "user-icon"
                        })([ React_DOM.span({
                            className: "user-icon2"
                        })([ React_DOM.span({
                            href: "https://twitter.com/" + _788.value0.value0.screen_name, 
                            target: "_blank"
                        })([ React_DOM.img({
                            className: "user-icon-img", 
                            onClick: loadUserFeed(_786)(_788.value0), 
                            style: {
                                cursor: "pointer"
                            }, 
                            src: _788.value0.value0.profile_image_url, 
                            onContextMenu: Utils.callEventHandler(handleAuthorContextMenu(_786)(_788.value0)), 
                            title: "Original author: " + _788.value0.value0.name
                        })([  ]) ]) ]), React_DOM.span({
                            className: "user-icon1"
                        })([ React_DOM.span({
                            href: "https://twitter.com/" + _787.value0.screen_name, 
                            target: "_blank"
                        })([ React_DOM.img({
                            className: "user-icon-img", 
                            onClick: loadUserFeed(_786)(_787), 
                            style: {
                                cursor: "pointer"
                            }, 
                            src: _787.value0.profile_image_url, 
                            onContextMenu: Utils.callEventHandler(handleAuthorContextMenu(_786)(_787)), 
                            title: _787.value0.name
                        })([  ]) ]) ]) ]);
                    };
                    throw new Error("Failed pattern match");
                };
            };
        };
        var renderFun = function ($$this) {
            return Prelude.pure(Control_Monad_Eff.applicativeEff)(React_DOM.li({
                id: $$this.props.id_str
            })([ authorToHtml($$this.props.state)($$this.props.author)($$this.props.retweeted_by), React_DOM.span({
                className: "tweet-body", 
                "data-tweet-id": $$this.props.id_str, 
                onContextMenu: Utils.callEventHandler(tweetContextMenu($$this.props.state)($$this.props.id_str))
            })(Prelude["<$>"](Data_Array.functorArray)(Prelude["<<<"](Prelude.semigroupoidArr)(UI_Types.asHtml(asHtmlTweetElement)($$this.props.state))(processTweetElement($$this.props.entities)))($$this.props.text)), UI_Types.asHtml(asHtmlEntities)($$this.props.state)($$this.props.entities) ]));
        };
        return React.createClass((function () {
            var _1395 = {};
            for (var _1396 in React.spec) {
                if (React.spec.hasOwnProperty(_1396)) {
                    _1395[_1396] = React.spec[_1396];
                };
            };
            _1395.displayName = "Tweet";
            _1395.render = renderFun;
            return _1395;
        })());
    })();
    var asHtmlTweet = new UI_Types.AsHtml(function (_778) {
        return function (_779) {
            if (_779.value0.retweet instanceof Data_Maybe.Nothing) {
                return tweetComponent({
                    state: _778, 
                    text: _779.value0.text, 
                    created_at: _779.value0.created_at, 
                    id: _779.value0.id, 
                    id_str: _779.value0.id_str, 
                    author: _779.value0.user, 
                    entities: _779.value0.entities, 
                    retweeted_by: Data_Maybe.Nothing.value
                })([  ]);
            };
            if (_779.value0.retweet instanceof Data_Maybe.Just) {
                return tweetComponent({
                    state: _778, 
                    text: _779.value0.retweet.value0.value0.text, 
                    created_at: _779.value0.created_at, 
                    id: _779.value0.id, 
                    id_str: _779.value0.id_str, 
                    author: _779.value0.user, 
                    entities: _779.value0.retweet.value0.value0.entities, 
                    retweeted_by: new Data_Maybe.Just(_779.value0.retweet.value0.value0.user)
                })([  ]);
            };
            throw new Error("Failed pattern match");
        };
    });
    var tweetsList = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _158 = Core.readState($$this.props.state)();
                return (function () {
                    if (_158.value0.extraFeed instanceof Data_Maybe.Nothing) {
                        return function __do() {
                            Core.setTitle((function () {
                                var _1423 = Data_Array.length(_158.value0.feed.value0.newFeed);
                                if (_1423 === 1) {
                                    return "1 new tweet";
                                };
                                return Prelude.show(Prelude.showNumber)(_1423) + " new tweets";
                            })())();
                            if (_158.value0.feed.value0.currentFeed.length === 0) {
                                return React_DOM.ul({
                                    id: "feed", 
                                    onClick: function (ev) {
                                        return feedClickHandler(ev);
                                    }
                                })([ React_DOM.li({
                                    className: "no-tweets"
                                })([ React_DOM.rawText("EOF") ]) ]);
                            };
                            return React_DOM.ul({
                                id: "feed", 
                                onClick: function (ev) {
                                    return feedClickHandler(ev);
                                }
                            })(Prelude["<$>"](Data_Array.functorArray)(UI_Types.asHtml(asHtmlTweet)($$this.props.state))(_158.value0.feed.value0.currentFeed));
                        };
                    };
                    if (_158.value0.extraFeed instanceof Data_Maybe.Just) {
                        return function __do() {
                            Core.setTitle(_158.value0.extraFeed.value0.value0.author.value0.screen_name + "'s tweets")();
                            if (_158.value0.extraFeed.value0.value0.currentFeed.length === 0) {
                                return React_DOM.ul({
                                    id: "feed", 
                                    onClick: function (ev) {
                                        return feedClickHandler(ev);
                                    }
                                })([ React_DOM.li({
                                    className: "no-tweets"
                                })([ React_DOM.rawText("EOF") ]) ]);
                            };
                            return React_DOM.ul({
                                id: "feed", 
                                onClick: function (ev) {
                                    return feedClickHandler(ev);
                                }
                            })(Prelude["<$>"](Data_Array.functorArray)(UI_Types.asHtml(asHtmlTweet)($$this.props.state))(_158.value0.extraFeed.value0.value0.currentFeed));
                        };
                    };
                    throw new Error("Failed pattern match");
                })()();
            };
        };
        return React.createClass((function () {
            var _1439 = {};
            for (var _1440 in React.spec) {
                if (React.spec.hasOwnProperty(_1440)) {
                    _1439[_1440] = React.spec[_1440];
                };
            };
            _1439.displayName = "TweetsList";
            _1439.render = renderFun;
            return _1439;
        })());
    })();
    return {
        tweetsList: tweetsList, 
        tweetComponent: tweetComponent, 
        tweetContextMenu: tweetContextMenu, 
        showContextMenu: showContextMenu, 
        tweetMenu: tweetMenu, 
        loadUserFeed: loadUserFeed, 
        loadUserFeedByName: loadUserFeedByName, 
        getOrigTweetUrl: getOrigTweetUrl, 
        processTweetElement: processTweetElement, 
        feedClickHandler: feedClickHandler, 
        handleReplyClick: handleReplyClick, 
        getTweetById: getTweetById, 
        handleAuthorContextMenu: handleAuthorContextMenu, 
        handleStarClick: handleStarClick, 
        handleRetweetClick: handleRetweetClick, 
        startWsClient: startWsClient, 
        listenFeedKeys: listenFeedKeys, 
        checkButton: checkButton, 
        historyButton: historyButton, 
        maybeLoadMoreHistory: maybeLoadMoreHistory, 
        getHistoryUrl: getHistoryUrl, 
        onNewTweets: onNewTweets, 
        onHistoryTweets: onHistoryTweets, 
        onError: onError, 
        showOldTweets: showOldTweets, 
        showNewTweets: showNewTweets, 
        asHtmlTweetElement: asHtmlTweetElement, 
        asHtmlTweet: asHtmlTweet, 
        asHtmlAuthor: asHtmlAuthor, 
        asHtmlEntities: asHtmlEntities, 
        asHtmlMedia: asHtmlMedia
    };
})();
var PS = PS || {};
PS.UI_FeedMetadata = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Core = PS.Core;
    var Optic_Core = PS.Optic_Core;
    var React_DOM = PS.React_DOM;
    var Utils = PS.Utils;
    var UI_Feed = PS.UI_Feed;
    var React = PS.React;
    var UI_Types = PS.UI_Types;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Types = PS.Types;
    var Data_Array = PS.Data_Array;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Data_Identity = PS.Data_Identity;
    var handleBack = function (state) {
        return function __do() {
            var _159 = Core.readState(state)();
            return Core.writeState(state)(Optic_Core[".~"](Core.extraFeedL(Data_Identity.functorIdentity))(Data_Maybe.Nothing.value)(_159))();
        };
    };
    var feedMetadata = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _160 = Core.readState($$this.props.state)();
                return (function () {
                    if (_160.value0.extraFeed instanceof Data_Maybe.Just) {
                        return Prelude.pure(Control_Monad_Eff.applicativeEff)(React_DOM.div({
                            className: "feed-meta"
                        })([ React_DOM.button({
                            className: "user-icon", 
                            style: {
                                "border-radius": "50%", 
                                border: "0px", 
                                margin: "20px", 
                                cursor: "pointer", 
                                "margin-right": "5px"
                            }, 
                            onClick: handleBack($$this.props.state)
                        })([ React_DOM.rawText("\u2190") ]), React_DOM.span({
                            className: "user-icon", 
                            style: {
                                margin: "20px", 
                                "margin-left": "5px", 
                                display: "inline-block"
                            }
                        })([ React_DOM.a({
                            href: "https://twitter.com/" + _160.value0.extraFeed.value0.value0.author.value0.screen_name, 
                            target: "_blank"
                        })([ React_DOM.img({
                            className: "user-icon-img", 
                            src: _160.value0.extraFeed.value0.value0.author.value0.profile_image_url, 
                            onContextMenu: Utils.callEventHandler(UI_Feed.handleAuthorContextMenu($$this.props.state)(_160.value0.extraFeed.value0.value0.author)), 
                            title: _160.value0.extraFeed.value0.value0.author.value0.name
                        })([  ]) ]) ]) ]));
                    };
                    if (_160.value0.extraFeed instanceof Data_Maybe.Nothing) {
                        return Prelude.pure(Control_Monad_Eff.applicativeEff)(React_DOM.div({})([  ]));
                    };
                    throw new Error("Failed pattern match");
                })()();
            };
        };
        return React.createClass((function () {
            var _1453 = {};
            for (var _1454 in React.spec) {
                if (React.spec.hasOwnProperty(_1454)) {
                    _1453[_1454] = React.spec[_1454];
                };
            };
            _1453.displayName = "feedMetadata";
            _1453.render = renderFun;
            return _1453;
        })());
    })();
    return {
        feedMetadata: feedMetadata, 
        handleBack: handleBack
    };
})();
var PS = PS || {};
PS.UI_RootLayout = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Utils = PS.Utils;
    var Core = PS.Core;
    var UI_TweetWriter = PS.UI_TweetWriter;
    var UI_UserInfo = PS.UI_UserInfo;
    var React_DOM = PS.React_DOM;
    var UI_Messages = PS.UI_Messages;
    var UI_FeedMetadata = PS.UI_FeedMetadata;
    var UI_Feed = PS.UI_Feed;
    var React = PS.React;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var DOM = PS.DOM;
    var React_Types = PS.React_Types;
    var Types = PS.Types;
    var Data_Maybe = PS.Data_Maybe;
    var resetMenus = function (state) {
        return function __do() {
            Core.resetContextMenu(state)();
            UI_UserInfo.hideUserInfo(state)();
            return UI_TweetWriter.hideWriteInput(state)();
        };
    };
    var contextMenuHandler = function (state) {
        return function (ev) {
            return function __do() {
                Utils.stopPropagation(ev)();
                Core.resetContextMenu(state)();
                return UI_TweetWriter.showWriteInput(state)();
            };
        };
    };
    var rootLayout = (function () {
        var renderFun = function ($$this) {
            return function __do() {
                var _161 = Core.readState($$this.props.state)();
                return React_DOM.div({
                    className: "root-layout", 
                    onContextMenu: Utils.callEventHandler(contextMenuHandler($$this.props.state)), 
                    onClick: resetMenus($$this.props.state)
                })([ React_DOM.div({
                    className: "error", 
                    id: "messages"
                })([ UI_Messages.errorsList({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    id: "feed-metadata-container-id"
                })([ UI_FeedMetadata.feedMetadata({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    id: "load-history-container-id"
                })([ UI_Feed.historyButton({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    className: "container", 
                    id: "container"
                })([ UI_Feed.tweetsList({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    className: "refresh", 
                    id: "refresh"
                })([ UI_Feed.checkButton({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    id: "write-tweet-container-id"
                })([ UI_TweetWriter.writeInputComponent({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    id: "ctx-menu-container-id"
                })([ UI_Feed.tweetMenu({
                    state: $$this.props.state
                })([  ]) ]), React_DOM.div({
                    id: "userinfo-container-id"
                })([ UI_UserInfo.userInfo({
                    state: $$this.props.state
                })([  ]) ]) ]);
            };
        };
        return React.createClass((function () {
            var _1463 = {};
            for (var _1464 in React.spec) {
                if (React.spec.hasOwnProperty(_1464)) {
                    _1463[_1464] = React.spec[_1464];
                };
            };
            _1463.displayName = "RootLayout";
            _1463.render = renderFun;
            return _1463;
        })());
    })();
    var renderRootLayout = function (targetId) {
        return function (state) {
            return React.renderComponentById(rootLayout({
                state: state
            })([  ]))(targetId);
        };
    };
    return {
        renderRootLayout: renderRootLayout, 
        rootLayout: rootLayout, 
        resetMenus: resetMenus, 
        contextMenuHandler: contextMenuHandler
    };
})();
var PS = PS || {};
PS.Main = (function () {
    "use strict";
    var Utils = PS.Utils;
    var Core = PS.Core;
    var Prelude = PS.Prelude;
    var Debug_Trace = PS.Debug_Trace;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var UI_RootLayout = PS.UI_RootLayout;
    var UI_TweetWriter = PS.UI_TweetWriter;
    var UI_UserInfo = PS.UI_UserInfo;
    var UI_Feed = PS.UI_Feed;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Config = PS.Config;
    var Types = PS.Types;
    var main = (function () {
        var listenState = function (state) {
            return function (rl) {
                return Utils["~>"](Core.stateObservable)(function (_789) {
                    return function __do() {
                        Debug_Trace.trace("Got state update" + Utils.toString(state))();
                        Utils.setProps(rl)(state)();
                        return Prelude.unit;
                    };
                });
            };
        };
        return function __do() {
            Debug_Trace.trace("hello there")();
            var _163 = Control_Monad_Eff_Ref.newRef(Core.initialState)();
            var _162 = UI_RootLayout.renderRootLayout("root")(_163)();
            listenState(_163)(_162)();
            UI_TweetWriter.listenWriteKeys(_163)();
            UI_UserInfo.listenUserInfoKeys(_163)();
            UI_Feed.listenFeedKeys(_163)();
            UI_Feed.startWsClient(_163)();
            return Prelude.unit;
        };
    })();
    return {
        main: main
    };
})();
PS.Main.main();
